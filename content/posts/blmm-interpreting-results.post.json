{
  "title": "Big Linear Mixed Models (BLMM)",
  "metadata": {
    "method_family": "BLMM",
    "method_family_label": "Big Linear Mixed Models (BLMM)",
    "statistical_engine": "blmm",
    "engines": [
      "blmm"
    ],
    "covariates": "Multiple",
    "outcome_type": "Continuous",
    "updated_at": "2025-01-15",
    "tags": [
      "abcd-study",
      "python",
      "mixed-models",
      "longitudinal",
      "neuroimaging",
      "blmm"
    ],
    "author": "Biostatistics Working Group",
    "description": "Understanding and interpreting mass-univariate Linear Mixed Model results from neuroimaging analyses using the BLMM toolbox.",
    "summary": "Understanding and interpreting mass-univariate Linear Mixed Model results from neuroimaging analyses using the BLMM toolbox.",
    "difficulty": "advanced",
    "timepoints": "3_5"
  },
  "overview": {
    "summary": "Big Linear Mixed Models (BLMM) is a Python toolbox designed for fitting mass-univariate linear mixed models at scale, particularly for neuroimaging analyses involving large sample sizes and high-dimensional outcomes. This tutorial demonstrates how to understand and interpret BLMM outputs using results from an analysis of ABCD Study neuroimaging data. Rather than running the analysis (which requires HPC infrastructure), we focus on interpreting pre-computed results to understand what BLMM produces and how to draw scientific conclusions from its outputs.",
    "stats_panel": {
      "title": "Stats",
      "items": [
        {
          "label": "Subjects:",
          "value": "5,179"
        },
        {
          "label": "Observations:",
          "value": "9,835"
        },
        {
          "label": "Fixed Effects:",
          "value": "23"
        },
        {
          "label": "Contrasts Tested:",
          "value": "5"
        },
        {
          "label": "Random Effects:",
          "value": "Subject-level intercepts and slopes"
        }
      ]
    },
    "features_panel": {
      "title": "Features",
      "items": [
        {
          "heading": "When to Use:",
          "text": "Large-scale longitudinal neuroimaging analyses with repeated measures, where traditional mixed model software struggles with computational demands"
        },
        {
          "heading": "Key Advantage:",
          "text": "Scales to tens of thousands of images with vertex/voxel-wise analysis while properly accounting for within-subject correlation"
        },
        {
          "heading": "What You'll Learn:",
          "text": "How to interpret BLMM output files including fixed effects (β), variance components (σ², D), t-statistics, and p-values mapped onto cortical surfaces"
        }
      ]
    }
  },
  "data_access": {
    "items": [
      {
        "type": "collapsible",
        "title": "Study Background",
        "content": "<p>The data presented in this tutorial are drawn from the <a href=\"https://abcdstudy.org/\">Adolescent Brain Cognitive Development (ABCD) Study</a>, the largest long-term study of brain development and child health in the United States. The ABCD Study follows approximately 12,000 youth from age 9-10 through early adulthood, collecting neuroimaging, behavioral, and environmental data at regular intervals.</p>\n",
        "open": false
      },
      {
        "type": "collapsible",
        "title": "Task and Response Variable",
        "content": "<p>The experiment conducted in this study was a <a href=\"https://en.wikipedia.org/wiki/N-back\">working memory N-back task</a>. The response variable of interest was the percent <a href=\"https://en.wikipedia.org/wiki/Blood-oxygen-level-dependent_imaging\">BOLD</a> (Blood Oxygenation Level Dependent) signal—a measure of blood flow in the brain which acts as a proxy for neuronal activity.</p>\n<p>Prior analyses produced a 2-vs-0 back contrast image for each subject and session, reflecting the subject's average percent BOLD change in response to the 2-back task during a particular session. In each image, the average percent BOLD change is recorded for every vertex on a predefined cortical surface.</p>\n",
        "open": false
      },
      {
        "type": "collapsible",
        "title": "Sample Characteristics",
        "content": "<p>In total, the response data consists of 9,835 fMRI surface images. These images were drawn from 5,179 subjects, each of whom had data recorded for between 1 and 3 visits.</p>\n",
        "open": false
      },
      {
        "type": "collapsible",
        "title": "Design Matrix",
        "content": "<p>We are interested in understanding how a range of independent variables impacted the task-specific percent BOLD response. The design matrix for both analyses included:</p>\n<ul>\n<li><strong>Intercept:</strong> Modeling average response</li>\n<li><strong>Sex:</strong> The subject's biological sex</li>\n<li><strong>Cross-sectional Age:</strong> The age of the subject at the first timepoint</li>\n<li><strong>Longitudinal Time:</strong> The difference in the subject's age from the first timepoint recorded</li>\n<li><strong>NIH Cognition Score (Age Corrected):</strong> The subject's age-corrected total score from the neurocognitive battery derived from seven measures from the NIH Toolbox</li>\n<li><strong>Race:</strong> Categorical variable indicating the subject's race (white, black, asian, or other)</li>\n<li><strong>Ethnicity:</strong> Categorical variable indicating the subject's ethnicity (hispanic or other)</li>\n<li><strong>Parental Education Level:</strong> Categorical variable representing the subject's parent's education (high school, college, bachelor, postgraduate)</li>\n<li><strong>Family Income:</strong> Categorical variable representing the subject's family income (less than 50K, 50K-100K, greater than 100K)</li>\n<li><strong>Marital Status:</strong> Categorical variable representing the marital status of the subject's parents</li>\n</ul>\n",
        "open": false
      }
    ]
  },
  "data_preparation": {
    "content_blocks": [
      {
        "type": "note",
        "data": {
          "title": "The Linear Mixed Model",
          "content": "<p>The Linear Mixed Model can be represented in the form:</p>\n<p><div class=\"math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>X</mi><mi>β</mi><mo>+</mo><mi>Z</mi><mi>b</mi><mo>+</mo><mi>ϵ</mi><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi>ϵ</mi><mo>∼</mo><mi>N</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><msup><mi>σ</mi><mn>2</mn></msup><mi>I</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi>b</mi><mo>∼</mo><mi>N</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><msup><mi>σ</mi><mn>2</mn></msup><mi>D</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Y = X\\beta + Zb + \\epsilon, \\quad \\epsilon \\sim N(0,\\sigma^2I), \\quad b \\sim N(0,\\sigma^2D)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">Xβ</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mclose\">)</span></span></span></span></span></div></p>\n<p>where, assuming the model includes <span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span> observations, <span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span></span> fixed effects and <span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span> random effects, the model matrices are:</p>\n<ul>\n<li><span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span></span>: the <span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo>×</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(n \\times p)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span></span></span></span></span> fixed effects (independent variables) design matrix</li>\n<li><span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Z</mi></mrow><annotation encoding=\"application/x-tex\">Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span></span></span>: the <span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo>×</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(n \\times q)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mclose\">)</span></span></span></span></span> random effects design matrix</li>\n</ul>\n<p>The random terms are:</p>\n<ul>\n<li><span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span></span>: the <span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo>×</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(n \\times 1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></span> response vector</li>\n<li><span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span></span></span>: the <span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo>×</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(n \\times 1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></span> error vector</li>\n<li><span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span></span>: the <span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo>×</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(q \\times 1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></span> random effects vector</li>\n</ul>\n<p>Our interest lies in estimating the parameters:</p>\n<ul>\n<li><span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">\\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span></span>: the <span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>p</mi><mo>×</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(p \\times 1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></span> fixed effects coefficient vector</li>\n<li><span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\sigma^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span>: the scalar residual variance</li>\n<li><span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span></span>: the <span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>q</mi><mo>×</mo><mi>q</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(q \\times q)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mclose\">)</span></span></span></span></span> random effects covariance matrix</li>\n</ul>\n<p>The input and output of BLMM is labeled according to these notational conventions.</p>"
        }
      },
      {
        "type": "note",
        "data": {
          "title": "Analysis Designs",
          "content": "<p>The two analysis designs differed in the random effects included in the model:</p>\n<ul>\n<li><strong>Design 1:</strong> Included a subject-level intercept as a random effect. This models the within-subject variability in the data.</li>\n<li><strong>Design 2:</strong> Included both a subject-level intercept and longitudinal time effect. This models the variation in individual subject's trajectories.</li>\n</ul>\n<p>As random slopes cannot be considered for singleton subjects (those with only one observation), Design 2 was constrained to consider only subjects with 2 or more visits.</p>"
        }
      },
      {
        "type": "note",
        "data": {
          "title": "BLMM Configuration",
          "content": "<pre><code class=\"language-yaml\"><span class=\"syn-comment\">#</span><span class=\"syn-comment\"> Example blmm_inputs.yml structure\n</span><span class=\"syn-number\">Missingness</span><span class=\"syn-function\">:</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">  </span><span class=\"syn-number\">MinPercent</span><span class=\"syn-function\">:</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0.5</span><span class=\"syn-function\">\n</span><span class=\"syn-number\">X</span><span class=\"syn-function\">:</span><span class=\"syn-function\"> </span><span class=\"syn-string\">/path/to/X.csv</span><span class=\"syn-function\">\n</span><span class=\"syn-number\">Y_files</span><span class=\"syn-function\">:</span><span class=\"syn-function\"> </span><span class=\"syn-string\">/path/to/y_files.txt</span><span class=\"syn-function\">\n</span><span class=\"syn-number\">analysis_mask</span><span class=\"syn-function\">:</span><span class=\"syn-function\"> </span><span class=\"syn-string\">/path/to/analysis/mask</span><span class=\"syn-function\">\n</span><span class=\"syn-number\">clusterType</span><span class=\"syn-function\">:</span><span class=\"syn-function\"> </span><span class=\"syn-string\">SLURM</span><span class=\"syn-function\">\n</span><span class=\"syn-number\">Z</span><span class=\"syn-function\">:</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">-</span><span class=\"syn-function\"> </span><span class=\"syn-number\">f1</span><span class=\"syn-function\">:</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">    </span><span class=\"syn-number\">design</span><span class=\"syn-function\">:</span><span class=\"syn-function\"> </span><span class=\"syn-string\">/path/to/factor_design_matrix.csv</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">    </span><span class=\"syn-number\">factor</span><span class=\"syn-function\">:</span><span class=\"syn-function\"> </span><span class=\"syn-string\">/path/to/factor_vector.csv</span><span class=\"syn-function\">\n</span><span class=\"syn-number\">contrasts</span><span class=\"syn-function\">:</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">-</span><span class=\"syn-function\"> </span><span class=\"syn-number\">c1</span><span class=\"syn-function\">:</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">    </span><span class=\"syn-number\">name</span><span class=\"syn-function\">:</span><span class=\"syn-function\"> </span><span class=\"syn-string\">Intercept</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">    </span><span class=\"syn-number\">vector</span><span class=\"syn-function\">:</span><span class=\"syn-function\"> </span><span class=\"syn-function\">[</span><span class=\"syn-number\">1</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">]</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">-</span><span class=\"syn-function\"> </span><span class=\"syn-number\">c2</span><span class=\"syn-function\">:</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">    </span><span class=\"syn-number\">name</span><span class=\"syn-function\">:</span><span class=\"syn-function\"> </span><span class=\"syn-string\">Sex</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">    </span><span class=\"syn-number\">vector</span><span class=\"syn-function\">:</span><span class=\"syn-function\"> </span><span class=\"syn-function\">[</span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">1</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">]</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">-</span><span class=\"syn-function\"> </span><span class=\"syn-number\">c3</span><span class=\"syn-function\">:</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">    </span><span class=\"syn-number\">name</span><span class=\"syn-function\">:</span><span class=\"syn-function\"> </span><span class=\"syn-string\">CrossSectionalAge</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">    </span><span class=\"syn-number\">vector</span><span class=\"syn-function\">:</span><span class=\"syn-function\"> </span><span class=\"syn-function\">[</span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">1</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">]</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">-</span><span class=\"syn-function\"> </span><span class=\"syn-number\">c4</span><span class=\"syn-function\">:</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">    </span><span class=\"syn-number\">name</span><span class=\"syn-function\">:</span><span class=\"syn-function\"> </span><span class=\"syn-string\">LongitudinalTime</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">    </span><span class=\"syn-number\">vector</span><span class=\"syn-function\">:</span><span class=\"syn-function\"> </span><span class=\"syn-function\">[</span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">1</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">]</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">-</span><span class=\"syn-function\"> </span><span class=\"syn-number\">c5</span><span class=\"syn-function\">:</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">    </span><span class=\"syn-number\">name</span><span class=\"syn-function\">:</span><span class=\"syn-function\"> </span><span class=\"syn-string\">NIHScore</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">    </span><span class=\"syn-number\">vector</span><span class=\"syn-function\">:</span><span class=\"syn-function\"> </span><span class=\"syn-function\">[</span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">1</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">0</span><span class=\"syn-function\">]</span><span class=\"syn-function\">\n</span><span class=\"syn-number\">outdir</span><span class=\"syn-function\">:</span><span class=\"syn-function\"> </span><span class=\"syn-string\">/path/to/output</span><span class=\"syn-function\">\n</span></code></pre>"
        }
      },
      {
        "type": "note",
        "data": {
          "title": "Configuration Explanation",
          "content": "<p>In the configuration file:</p>\n<ul>\n<li><strong>Missingness:</strong> The <code>MinPercent: 0.5</code> parameter tells BLMM to report results for any vertex with at least 50% of observations present</li>\n<li><strong>X.csv:</strong> Contains the fixed effects design matrix of size <span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo>×</mo><mi>p</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(n \\times p)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span></span></span></span></span></li>\n<li><strong>Y_files.txt:</strong> A text file containing paths to the surface images</li>\n<li><strong>analysis_mask:</strong> Specifies which vertices to analyze</li>\n<li><strong>clusterType:</strong> The type of computational cluster (e.g., Local, SLURM, SGE)</li>\n<li><strong>Z:</strong> Specifies random effects structure. The <code>factor</code> file is an <span class=\"math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo>×</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(n \\times 1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></span> vector indicating which subject each observation belongs to. The <code>design</code> file contains the random effects design matrix.</li>\n<li><strong>contrasts:</strong> Defines the null hypotheses to test (here: Intercept, Sex, Age, Time, NIH Score)</li>\n</ul>"
        }
      }
    ]
  },
  "statistical_analysis": {
    "content_blocks": [
      {
        "type": "note",
        "data": {
          "title": "Loading Libraries",
          "content": "<pre><code class=\"language-python\"><span class=\"syn-keyword\">import</span><span class=\"syn-function\"> </span><span class=\"syn-function\">os</span><span class=\"syn-function\">\n</span><span class=\"syn-keyword\">import</span><span class=\"syn-function\"> </span><span class=\"syn-function\">numpy</span><span class=\"syn-function\"> </span><span class=\"syn-keyword\">as</span><span class=\"syn-function\"> </span><span class=\"syn-function\">np</span><span class=\"syn-function\">\n</span><span class=\"syn-keyword\">import</span><span class=\"syn-function\"> </span><span class=\"syn-function\">nibabel</span><span class=\"syn-function\"> </span><span class=\"syn-keyword\">as</span><span class=\"syn-function\"> </span><span class=\"syn-function\">nib</span><span class=\"syn-function\">\n</span><span class=\"syn-keyword\">from</span><span class=\"syn-function\"> </span><span class=\"syn-function\">demo</span><span class=\"syn-function\">.</span><span class=\"syn-function\">plot</span><span class=\"syn-function\"> </span><span class=\"syn-keyword\">import</span><span class=\"syn-function\"> </span><span class=\"syn-function\">plot_brain_surface</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">\n</span><span class=\"syn-comment\">#</span><span class=\"syn-comment\"> Geometry file paths (FreeSurfer pial surfaces)\n</span><span class=\"syn-function\">geom_lh</span><span class=\"syn-function\"> </span><span class=\"syn-function\">=</span><span class=\"syn-function\"> </span><span class=\"syn-function\">&quot;</span><span class=\"syn-string\">demo/geom/lh.pial</span><span class=\"syn-function\">&quot;</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">geom_rh</span><span class=\"syn-function\"> </span><span class=\"syn-function\">=</span><span class=\"syn-function\"> </span><span class=\"syn-function\">&quot;</span><span class=\"syn-string\">demo/geom/rh.pial</span><span class=\"syn-function\">&quot;</span><span class=\"syn-function\">\n</span></code></pre>"
        }
      },
      {
        "type": "note",
        "data": {
          "title": "Output File Structure",
          "content": "<p>BLMM produces the following output files for each analysis:</p>\n<table><thead><tr><th>File</th><th>Description</th><th>Dimensions</th></tr></thead><tbody>\n<tr><td><code>blmm_vox_beta.dat</code></td><td>Fixed effect estimates (β)</td><td>vertices × 23 coefficients</td></tr>\n<tr><td><code>blmm_vox_con.dat</code></td><td>Contrast estimates</td><td>vertices × 5 contrasts</td></tr>\n<tr><td><code>blmm_vox_conSE.dat</code></td><td>Standard errors for contrasts</td><td>vertices × 5 contrasts</td></tr>\n<tr><td><code>blmm_vox_conT.dat</code></td><td>T-statistics for contrasts</td><td>vertices × 5 contrasts</td></tr>\n<tr><td><code>blmm_vox_conTlp.dat</code></td><td>-log₁₀(p-values)</td><td>vertices × 5 contrasts</td></tr>\n<tr><td><code>blmm_vox_sigma2.dat</code></td><td>Residual variance (σ²)</td><td>vertices × 1</td></tr>\n<tr><td><code>blmm_vox_D.dat</code></td><td>Random effects covariance (D)</td><td>vertices × elements of D</td></tr>\n<tr><td><code>blmm_vox_n.dat</code></td><td>Sample size per vertex</td><td>vertices × 1</td></tr>\n<tr><td><code>blmm_vox_llh.dat</code></td><td>Log-likelihood</td><td>vertices × 1</td></tr>\n<tr><td><code>blmm_vox_edf.dat</code></td><td>Effective degrees of freedom</td><td>vertices × 1</td></tr>\n</tbody></table>\n<p>Results are organized by hemisphere (lh/rh) and design (des1/des2).</p>"
        }
      },
      {
        "type": "note",
        "data": {
          "title": "Viewing Results",
          "content": "<pre><code class=\"language-python\"><span class=\"syn-comment\">#</span><span class=\"syn-comment\"> Specify the analysis to examine\n</span><span class=\"syn-function\">analysis</span><span class=\"syn-function\"> </span><span class=\"syn-function\">=</span><span class=\"syn-function\"> </span><span class=\"syn-function\">&quot;</span><span class=\"syn-string\">des1</span><span class=\"syn-function\">&quot;</span><span class=\"syn-function\">  </span><span class=\"syn-comment\">#</span><span class=\"syn-comment\"> or &quot;des2&quot; for random slopes model\n</span><span class=\"syn-function\">hemisphere</span><span class=\"syn-function\"> </span><span class=\"syn-function\">=</span><span class=\"syn-function\"> </span><span class=\"syn-function\">&quot;</span><span class=\"syn-string\">lh</span><span class=\"syn-function\">&quot;</span><span class=\"syn-function\">  </span><span class=\"syn-comment\">#</span><span class=\"syn-comment\"> or &quot;rh&quot;\n</span><span class=\"syn-function\">\n</span><span class=\"syn-comment\">#</span><span class=\"syn-comment\"> Load t-statistics for contrasts\n</span><span class=\"syn-function\">data_path</span><span class=\"syn-function\"> </span><span class=\"syn-function\">=</span><span class=\"syn-function\"> </span><span class=\"syn-keyword\">f</span><span class=\"syn-function\">&quot;</span><span class=\"syn-string\">demo/results_</span><span class=\"syn-function\">{</span><span class=\"syn-function\">hemisphere</span><span class=\"syn-function\">}</span><span class=\"syn-string\">_</span><span class=\"syn-function\">{</span><span class=\"syn-function\">analysis</span><span class=\"syn-function\">}</span><span class=\"syn-string\">/blmm_vox_conT.dat</span><span class=\"syn-function\">&quot;</span><span class=\"syn-function\">\n</span><span class=\"syn-function\">\n</span><span class=\"syn-comment\">#</span><span class=\"syn-comment\"> Visualize a specific contrast (volume_number selects the contrast)\n</span><span class=\"syn-comment\">#</span><span class=\"syn-comment\"> Volume 0 = Intercept, 1 = Sex, 2 = Age, 3 = Time, 4 = NIH Score\n</span><span class=\"syn-function\">plot_brain_surface</span><span class=\"syn-function\">(</span><span class=\"syn-function\">data_path</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-function\">geom_lh</span><span class=\"syn-function\">,</span><span class=\"syn-function\"> </span><span class=\"syn-number\">volume_number</span><span class=\"syn-function\">=</span><span class=\"syn-number\">1</span><span class=\"syn-function\">)</span><span class=\"syn-function\">\n</span></code></pre>"
        }
      },
      {
        "type": "output",
        "data": {
          "content": "/stage4-artifacts/blmm-interpreting-results/dual_hemisphere.png",
          "format": "image",
          "alt": "BLMM T-statistics for both hemispheres showing Design 1 results with threshold of 2.0"
        }
      },
      {
        "type": "viewer",
        "data": {
          "manifest_path": "/data/blmm/manifest.json",
          "overrides": {
            "volume_idx": 1,
            "statistic": "conT"
          },
          "caption": "Interactive BLMM t-statistics viewer. Explore different contrasts, statistics, and analysis designs on the cortical surface.",
          "fallback_image": "/stage4-artifacts/blmm-interpreting-results/dual_hemisphere.png",
          "fallback_alt": "Static BLMM t-statistics for both hemispheres (Design 1, Sex contrast, threshold 2.0)"
        }
      },
      {
        "type": "note",
        "data": {
          "title": "Interpretation of T-Statistics",
          "content": "<p>The figure above displays t-statistics from Design 1 (random intercepts only) for both hemispheres. Key observations:</p>\n<ul>\n<li><strong>Color scale:</strong> Blue indicates negative effects, red indicates positive effects</li>\n<li><strong>Threshold:</strong> Values with |t| &lt; 2.0 are shown in gray (approximately p &gt; 0.05)</li>\n<li><strong>Spatial patterns:</strong> Strong bilateral effects are visible in frontal and parietal regions associated with working memory</li>\n</ul>"
        }
      },
      {
        "type": "output",
        "data": {
          "content": "/stage4-artifacts/blmm-interpreting-results/lh_statistics_grid.png",
          "format": "image",
          "alt": "Comparison of different BLMM output statistics: beta coefficients, t-statistics, -log10(p-values), and residual variance"
        }
      },
      {
        "type": "note",
        "data": {
          "title": "Understanding Different Output Types",
          "content": "<p>The statistics grid above shows four key outputs from BLMM:</p>\n<ul>\n<li><strong>beta (β):</strong> Raw fixed effect coefficients. Values represent the estimated change in percent BOLD per unit change in the predictor.</li>\n<li><strong>conT:</strong> T-statistics for testing whether contrasts differ from zero. Larger absolute values indicate stronger evidence against the null hypothesis.</li>\n<li><strong>conTlp:</strong> Negative log₁₀ of p-values. Values &gt; 1.3 correspond to p &lt; 0.05; values &gt; 2 correspond to p &lt; 0.01. This transformation makes significant regions more visually apparent.</li>\n<li><strong>sigma2 (σ²):</strong> Residual variance at each vertex. Higher values indicate more unexplained variability in the BOLD response.</li>\n</ul>"
        }
      },
      {
        "type": "output",
        "data": {
          "content": "/stage4-artifacts/blmm-interpreting-results/all_volumes_overview.png",
          "format": "image",
          "alt": "Overview of all five contrast t-statistics across left hemisphere"
        }
      },
      {
        "type": "note",
        "data": {
          "title": "Contrast Interpretation",
          "content": "<p>The five contrasts tested in this analysis:</p>\n<ul>\n<li><strong>Volume 0 (Intercept):</strong> Average BOLD response during the 2-back task</li>\n<li><strong>Volume 1 (Sex):</strong> Difference in BOLD response between males and females</li>\n<li><strong>Volume 2 (Cross-sectional Age):</strong> Association between baseline age and BOLD response</li>\n<li><strong>Volume 3 (Longitudinal Time):</strong> Change in BOLD response over time within individuals</li>\n<li><strong>Volume 4 (NIH Score):</strong> Association between cognitive performance and BOLD response</li>\n</ul>\n<p>Each contrast reveals distinct spatial patterns, reflecting the neural correlates of these demographic and cognitive factors.</p>"
        }
      }
    ]
  },
  "discussion": {
    "items": [
      {
        "title": "Model Comparison",
        "content": "<p>BLMM allows for formal comparison between nested models using likelihood ratio tests. In this example, we compared:</p>\n<ul>\n<li><strong>Design 1:</strong> Random intercepts only (simpler model)</li>\n<li><strong>Design 2:</strong> Random intercepts + random slopes for time (more complex model)</li>\n</ul>\n<p>The comparison tests whether allowing individual trajectories to vary significantly improves model fit. This is implemented via the <code>blmm_compare</code> function, which outputs chi-squared statistics at each vertex.</p>\n<p><strong>Important:</strong> To perform comparison, the analyses must have equal sample sizes. The comparison shown is between Design 2 and a reduced version of Design 1 containing only subjects with 2 or more visits.</p>"
      },
      {
        "title": "When to Choose Each Design",
        "content": "<p><strong>Design 1 (Random Intercepts)</strong> is appropriate when:</p>\n<ul>\n<li>You have many singleton subjects (single timepoint)</li>\n<li>Primary interest is in between-subject effects</li>\n<li>Computational resources are limited</li>\n</ul>\n<p><strong>Design 2 (Random Intercepts + Slopes)</strong> is appropriate when:</p>\n<ul>\n<li>Most subjects have multiple timepoints</li>\n<li>Individual trajectories are expected to vary</li>\n<li>You want to model heterogeneity in longitudinal change</li>\n</ul>"
      },
      {
        "title": "Interpreting Results",
        "content": "<p>When interpreting BLMM results:</p>\n<ol>\n<li><strong>Multiple comparisons:</strong> With thousands of vertices tested, appropriate correction for multiple comparisons is essential (e.g., FDR, permutation testing)</li>\n<li><strong>Effect sizes:</strong> T-statistics indicate statistical significance but not practical importance. Consider the magnitude of β coefficients.</li>\n<li><strong>Spatial coherence:</strong> Isolated significant vertices may be noise; look for spatially coherent clusters</li>\n<li><strong>Biological plausibility:</strong> Interpret results in the context of known functional neuroanatomy</li>\n</ol>"
      },
      {
        "title": "Limitations",
        "content": "<ul>\n<li>BLMM assumes normally distributed residuals; violations may affect inference</li>\n<li>The mass-univariate approach treats each vertex independently, ignoring spatial correlation</li>\n<li>HPC resources are required for large-scale analyses</li>\n<li>Results depend on the quality of preprocessing and registration</li>\n</ul>"
      }
    ],
    "paragraphs": []
  },
  "additional_resources": {
    "cards": [
      {
        "title": "BLMM GitHub Repository",
        "badge": "CODE",
        "body": "The official BLMM repository contains installation instructions, documentation, and example configurations for running your own analyses.",
        "url": "https://github.com/TomMaullin/BLMM"
      },
      {
        "title": "BLMM NeuroImage Paper",
        "badge": "PAPER",
        "body": "The methodology paper describing the BLMM algorithm, validation studies, and computational approach.",
        "url": "https://www.sciencedirect.com/science/article/pii/S1053811923003488"
      },
      {
        "title": "ABCD Study",
        "badge": "DATA",
        "body": "The Adolescent Brain Cognitive Development Study website with information about data access and study protocols.",
        "url": "https://abcdstudy.org/"
      },
      {
        "title": "FreeSurfer",
        "badge": "TOOL",
        "body": "FreeSurfer is used for cortical surface reconstruction and provides the geometry files used in BLMM surface analyses.",
        "url": "https://surfer.nmr.mgh.harvard.edu/"
      },
      {
        "title": "Nilearn",
        "badge": "DOCS",
        "body": "Python library for neuroimaging data analysis and visualization, useful for exploring BLMM outputs.",
        "url": "https://nilearn.github.io/"
      }
    ]
  }
}