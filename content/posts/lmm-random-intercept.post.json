{
  "additional_resources": {
    "cards": [
      {
        "badge": "DOCS",
        "body": "Official CRAN documentation for the lme4 package, covering the lmer() function for fitting linear mixed-effects models with random intercepts. Includes detailed explanations of model specification syntax, variance component estimation, and interpretation of random effects.",
        "title": "lme4 Package Documentation",
        "url": "https://cran.r-project.org/package=lme4"
      },
      {
        "badge": "VIGNETTE",
        "body": "Comprehensive vignette by Douglas Bates et al. introducing linear mixed models with random intercepts, including the (1|group) formula syntax, intraclass correlation calculation, and comparison with fixed-effects-only models. Essential reading for understanding how lme4 estimates variance components.",
        "title": "Fitting Linear Mixed-Effects Models Using lme4",
        "url": "https://cran.r-project.org/web/packages/lme4/vignettes/lmer.pdf"
      },
      {
        "badge": "BOOK",
        "body": "Snijders & Bosker (2011). Foundational textbook on multilevel modeling, with Chapters 2-4 covering random intercept models, interpretation of variance components, intraclass correlation coefficients (ICC), and the distinction between within-person and between-person effects.",
        "title": "Multilevel Analysis: An Introduction",
        "url": "https://uk.sagepub.com/en-gb/eur/multilevel-analysis/book241434"
      },
      {
        "badge": "TOOL",
        "body": "R package for checking linear mixed model assumptions including normality of random effects, homoscedasticity, and influential observations. The check_model() function provides comprehensive diagnostic plots specifically designed for lme4 models.",
        "title": "performance Package for Model Diagnostics",
        "url": "https://easystats.github.io/performance/"
      }
    ]
  },
  "data_access": {
    "items": [
      {
        "content": "<p>ABCD data can be accessed through the <a href=\"https://nbdc.deapscience.com\">DEAP platform</a> or the <a href=\"https://nbdc-datashare.lassoinformatics.com\">NBDC Data Access Platform (LASSO)</a>, which provide user-friendly interfaces for creating custom datasets with point-and-click variable selection. For detailed instructions on accessing and downloading ABCD data, see the <a href=\"https://docs.deapscience.com\">DEAP documentation</a>.</p>\n",
        "open": false,
        "title": "Data Download",
        "type": "collapsible"
      },
      {
        "content": "<p>Once you have downloaded ABCD data files, the <a href=\"https://software.nbdc-datahub.org/NBDCtools/\"><strong>NBDCtools</strong></a> package provides efficient tools for loading and preparing your data for analysis. The package handles common data management tasks including:</p>\n<ul>\n<li><strong>Automatic data joining</strong> - Merges variables from multiple tables automatically</li>\n<li><strong>Built-in transformations</strong> - Converts categorical variables to factors, handles missing data codes, and adds variable labels</li>\n<li><strong>Event filtering</strong> - Easily selects specific assessment waves</li>\n</ul>\n<p>For more information, visit the <a href=\"https://software.nbdc-datahub.org/NBDCtools/\">NBDCtools documentation</a>.</p>\n",
        "open": false,
        "title": "Loading Data with NBDCtools",
        "type": "collapsible"
      },
      {
        "content": "<p>The <code>create_dataset()</code> function is the main tool for loading ABCD data:</p>\n<pre><code class=\"language-r\">library(NBDCtools)\n\n# Define variables needed for this analysis\nrequested_vars &lt;- c(\n  \"var_1\",   # Variable 1\n  \"var_2\",   # Variable 2\n  \"var_3\"    # Variable 3\n)\n\n# Set path to downloaded ABCD data files\ndata_dir &lt;- Sys.getenv(\"ABCD_DATA_PATH\", \"/path/to/abcd/6_0/phenotype\")\n\n# Load data with automatic transformations\nabcd_data &lt;- create_dataset(\n  dir_data = data_dir,\n  study = \"abcd\",\n  vars = requested_vars,\n  release = \"6.0\",\n  format = \"parquet\",\n  categ_to_factor = TRUE,   # Convert categorical variables to factors\n  value_to_na = TRUE,        # Convert missing codes (222, 333, etc.) to NA\n  add_labels = TRUE          # Add variable and value labels\n)\n</code></pre>\n",
        "open": false,
        "title": "Basic Usage",
        "type": "collapsible"
      },
      {
        "content": "<ul>\n<li><strong><code>vars</code></strong> - Vector of variable names to load</li>\n<li><strong><code>release</code></strong> - ABCD data release version (e.g., \"6.0\")</li>\n<li><strong><code>format</code></strong> - File format, typically \"parquet\" for efficiency</li>\n<li><strong><code>categ_to_factor</code></strong> - Automatically converts categorical variables to factors</li>\n<li><strong><code>value_to_na</code></strong> - Converts ABCD missing value codes to R's NA</li>\n<li><strong><code>add_labels</code></strong> - Adds descriptive labels to variables and values</li>\n</ul>\n",
        "open": false,
        "title": "Key Parameters",
        "type": "collapsible"
      },
      {
        "content": "<p>For more details on using NBDCtools:</p>\n<ul>\n<li><a href=\"https://software.nbdc-datahub.org/NBDCtools/articles/NBDCtools.html\">NBDCtools Getting Started Guide</a> - Complete package overview</li>\n<li><a href=\"https://software.nbdc-datahub.org/NBDCtools/articles/join.html\">Joining Data</a> - Advanced data merging strategies</li>\n<li><a href=\"https://software.nbdc-datahub.org/NBDCtools/articles/filter.html\">Filtering Events</a> - Selecting specific assessment waves</li>\n<li><a href=\"https://software.nbdc-datahub.org/NBDCtools/articles/transformation.html\">Data Transformations</a> - Preprocessing and cleaning</li>\n</ul>\n",
        "open": false,
        "title": "Additional NBDCtools Resources",
        "type": "collapsible"
      }
    ]
  },
  "data_preparation": {
    "content_blocks": [
      {
        "data": {
          "content": "### Load necessary libraries\nlibrary(NBDCtools)    # ABCD data access helper\n### Load necessary libraries\nlibrary(arrow)       # For reading Parquet files\nlibrary(tidyverse)   # For data manipulation & visualization\nlibrary(gtsummary)   # For generating publication-quality summary tables\nlibrary(rstatix)     # Provides tidy-format statistical tests\nlibrary(lme4)        # Linear mixed-effects models (LMMs)\nlibrary(kableExtra)  # Formatting & styling in HTML/Markdown reports\nlibrary(performance) # Useful functions for model diagnostics & comparisons\n\n### Load harmonized ABCD data required for this analysis\nrequested_vars <- c(\n  \"ab_g_dyn__design_site\",\n  \"ab_g_stc__design_id__fam\",\n  \"nc_y_nihtb__comp__cryst__fullcorr_tscore\"\n)\n\ndata_dir <- Sys.getenv(\"ABCD_DATA_PATH\", \"/path/to/abcd/6_0/phenotype\")\n\nabcd_data <- create_dataset(\n  dir_data = data_dir,\n  study = \"abcd\",\n  vars = requested_vars,\n  release = \"6.0\",\n  format = \"parquet\",\n  categ_to_factor = TRUE,   # Convert categorical variables to factors\n  value_to_na = TRUE,        # Convert missing codes (222, 333, etc.) to NA\n  add_labels = TRUE          # Add variable and value labels\n)\n\n#  Prepare data for LMM analysis\ndf_long <- abcd_data %>%\n    select(participant_id, session_id, ab_g_dyn__design_site, ab_g_stc__design_id__fam, nc_y_nihtb__comp__cryst__fullcorr_tscore) %>%\n    # Filter to include only 4 relevant measurement occasions\n    filter(session_id %in% c(\"ses-00A\", \"ses-02A\", \"ses-04A\", \"ses-06A\")) %>%\n    #  Ensure dataset is sorted by participant and session\n    arrange(participant_id, session_id) %>%\n    #  Convert categorical and numerical variables\n    mutate(\n        participant_id = factor(participant_id), # Convert IDs to factors\n        session_id = factor(session_id, # Convert session to a factors\n            levels = c(\"ses-00A\", \"ses-02A\", \"ses-04A\", \"ses-06A\"),\n            labels = c(\"Baseline\", \"Year_2\", \"Year_4\", \"Year_6\")\n        ),\n        time = as.numeric(session_id) - 1, # Convert session_id to numeric\n        ab_g_dyn__design_site = factor(ab_g_dyn__design_site),  # Convert site to a factor\n        ab_g_stc__design_id__fam = factor(ab_g_stc__design_id__fam), # Convert family id to a factor\n        nc_y_nihtb__comp__cryst__fullcorr_tscore =\n            round(as.numeric(nc_y_nihtb__comp__cryst__fullcorr_tscore), 2)\n    ) %>%\n    #  Rename variables for clarity\n    rename(\n        site = ab_g_dyn__design_site,\n        family_id = ab_g_stc__design_id__fam,\n        cognition = nc_y_nihtb__comp__cryst__fullcorr_tscore\n    ) %>%\n  #  Remove participants with any missing cognition scores across time points\n    group_by(participant_id) %>%\n    group_by(participant_id) %>%\n    filter(sum(!is.na(cognition)) >= 2) %>%  # Keep only participants with at least 2 non-missing cognition scores\n    ungroup() %>%\n    drop_na(site, family_id, participant_id, cognition)  # Ensure all remaining rows have complete cases",
          "language": "r",
          "title": "Loading and Initial Processing"
        },
        "type": "code"
      },
      {
        "data": {
          "content": "#  Create descriptive summary table\ndescriptives_table <- df_long %>%\n  select(session_id, cognition) %>%\n  tbl_summary(\n    by = session_id,\n    missing = \"no\",\n    label = list(\n      cognition ~ \"Cognition\"\n    ),\n    statistic = list(all_continuous() ~ \"{mean} ({sd})\")\n  ) %>%\n  modify_header(all_stat_cols() ~ \"**{level}**<br>N = {n}\") %>%\n  modify_spanning_header(all_stat_cols() ~ \"**Assessment Wave**\") %>%\n  bold_labels() %>%\n  italicize_levels()\n\n### Apply compact styling\ntheme_gtsummary_compact()\n\ndescriptives_table <- as_gt(descriptives_table)\n\n### Save the table as HTML\ngt::gtsave(descriptives_table, filename = \"descriptives_table.html\")\n\n### Print the table\ndescriptives_table",
          "language": "r",
          "title": "Descriptive Statistics"
        },
        "type": "code"
      },
      {
        "data": {
          "content": "<div id=\"lrflnhqugb\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n  <style>#lrflnhqugb table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#lrflnhqugb thead, #lrflnhqugb tbody, #lrflnhqugb tfoot, #lrflnhqugb tr, #lrflnhqugb td, #lrflnhqugb th {\n  border-style: none;\n}\n\n#lrflnhqugb p {\n  margin: 0;\n  padding: 0;\n}\n\n#lrflnhqugb .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 13px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#lrflnhqugb .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#lrflnhqugb .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#lrflnhqugb .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#lrflnhqugb .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lrflnhqugb .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lrflnhqugb .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lrflnhqugb .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#lrflnhqugb .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#lrflnhqugb .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#lrflnhqugb .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#lrflnhqugb .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#lrflnhqugb .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#lrflnhqugb .gt_group_heading {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#lrflnhqugb .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#lrflnhqugb .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#lrflnhqugb .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#lrflnhqugb .gt_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#lrflnhqugb .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lrflnhqugb .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#lrflnhqugb .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#lrflnhqugb .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#lrflnhqugb .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lrflnhqugb .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#lrflnhqugb .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#lrflnhqugb .gt_last_summary_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lrflnhqugb .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lrflnhqugb .gt_first_grand_summary_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#lrflnhqugb .gt_last_grand_summary_row_top {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lrflnhqugb .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#lrflnhqugb .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lrflnhqugb .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lrflnhqugb .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lrflnhqugb .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lrflnhqugb .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lrflnhqugb .gt_left {\n  text-align: left;\n}\n\n#lrflnhqugb .gt_center {\n  text-align: center;\n}\n\n#lrflnhqugb .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#lrflnhqugb .gt_font_normal {\n  font-weight: normal;\n}\n\n#lrflnhqugb .gt_font_bold {\n  font-weight: bold;\n}\n\n#lrflnhqugb .gt_font_italic {\n  font-style: italic;\n}\n\n#lrflnhqugb .gt_super {\n  font-size: 65%;\n}\n\n#lrflnhqugb .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#lrflnhqugb .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#lrflnhqugb .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#lrflnhqugb .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#lrflnhqugb .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#lrflnhqugb .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#lrflnhqugb .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#lrflnhqugb .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#lrflnhqugb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n  <table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"label\"><span class='gt_from_md'><strong>Characteristic</strong></span></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"4\" scope=\"colgroup\" id=\"level 1; stat_1\">\n        <div class=\"gt_column_spanner\"><span class='gt_from_md'><strong>Assessment Wave</strong></span></div>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"stat_1\"><span class='gt_from_md'><strong>Baseline</strong><br>N = 8310</span><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"stat_2\"><span class='gt_from_md'><strong>Year_2</strong><br>N = 7046</span><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"stat_3\"><span class='gt_from_md'><strong>Year_4</strong><br>N = 3244</span><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"stat_4\"><span class='gt_from_md'><strong>Year_6</strong><br>N = 2656</span><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-weight: bold;\">Cognition</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">51 (11)</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">49 (11)</td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\">50 (11)</td>\n<td headers=\"stat_4\" class=\"gt_row gt_center\">51 (10)</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"5\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span> <span class='gt_from_md'>Mean (SD)</span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n</body>",
          "format": "table"
        },
        "type": "output"
      }
    ]
  },
  "discussion": {
    "paragraphs": [
      "The fixed-effects portion of the random-intercept LMM estimated an average baseline cognition score of 50.6 points (SE = 0.12, p < .001) and a decline of 0.354 points per biennial assessment (SE = 0.044, p < .001). Although that slope is modest, it represents a consistent downward shift across the cohort, matching expectations for this age band.",
      "Random intercept variance (τ₀₀ = 83.20) and the resulting ICC of 0.69 revealed substantial between-person differences in starting cognition. Allowing each youth to have a unique intercept therefore captured the wide vertical spread visible in the trajectory plot, while the shared slope reflected our modeling choice to keep change rates parallel. Diagnostics showed well-behaved residuals, indicating that a simple random-intercept structure is adequate when interest centers on population-level decline and differences in baseline performance rather than individualized slopes."
    ]
  },
  "metadata": {
    "analysis_status": "unknown",
    "author": "Biostatistics Working Group",
    "covariates": "None",
    "data_prep_status": "unknown",
    "description": "Estimate linear mixed models with random intercepts to capture person-specific baselines, separating within- and between-subject variance in repeated ABCD measurements.",
    "execution_time_ms": 5989,
    "method_family": "LMM",
    "method_family_label": "Linear Mixed Models (LMM)",
    "outcome_type": "Continuous",
    "statistical_engine": "lme4",
    "tags": [
      "abcd-study",
      "linear-mixed-model",
      "random-intercept"
    ],
    "updated_at": "2025-11-05",
    "validated_at": "2025-11-14T22:38:34.557284+00:00",
    "validator_version": "1.0.0",
    "warnings": 0
  },
  "overview": {
    "features_panel": {
      "items": [
        {
          "heading": "When to Use:",
          "text": "Apply when you have repeated measures and expect individuals to differ mainly in baseline levels, not rates of change."
        },
        {
          "heading": "Key Advantage:",
          "text": "The model absorbs participant-specific intercepts, reducing bias from within-subject correlation and delivering cleaner estimates of the average longitudinal trajectory."
        },
        {
          "heading": "What You'll Learn:",
          "text": "How to fit a  random-intercept model, interpret the variance components, and visualize predicted trajectories that reflect individual starting points."
        }
      ],
      "title": "Features"
    },
    "summary": "Linear mixed models with random intercepts extend ordinary linear regression by allowing each participant to have a unique baseline level in addition to the overall mean intercept, accounting for individual differences while modeling change over time. This approach estimates population-level trajectories while capturing person-specific deviations in starting values. This tutorial analyzes cognition scores from ABCD youth across four annual assessments using random intercept LMMs, modeling cognitive trajectories while allowing individual variation in baseline performance to estimate overall time effects on cognition while accounting for individual differences in starting scores."
  },
  "statistical_analysis": {
    "content_blocks": [
      {
        "data": {
          "content": "#  Fit a Linear Mixed Model (LMM) with random intercepts\nmodel <- lmerTest::lmer(\n    cognition ~ time + (1 | site:family_id:participant_id), # Fixed effect (time), random intercept (participant_id, site, family_id)\n    data = df_long # Dataset containing repeated measures of cognition\n)\n\n# Generate a summary table for the LMM model\nmodel_summary_table <- gtsummary::tbl_regression(model,\n    digits = 3,\n    intercept = TRUE\n) %>%\n  gtsummary::as_gt()\n\n### Save the gt table\ngt::gtsave(\n  data = model_summary_table,\n  filename = \"model_summary.html\",\n  inline_css = FALSE\n)\n\n# Generate a summary table for the LMM model\nsjPlot::tab_model(model,\n    show.se = TRUE, show.df = FALSE, show.ci = FALSE,\n    digits = 3, pred.labels = c(\"Intercept\", \"Time\"),\n    dv.labels = c(\"LMM Model (lme4)\"), string.se = \"SE\",\n    string.p = \"P-Value\",\n    file = \"lmm_model_results.html\"\n)",
          "language": "r",
          "title": "Model Specification and Fitting"
        },
        "type": "code"
      },
      {
        "data": {
          "content": "<div id=\"axwafsbbge\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n  <style>#axwafsbbge table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#axwafsbbge thead, #axwafsbbge tbody, #axwafsbbge tfoot, #axwafsbbge tr, #axwafsbbge td, #axwafsbbge th {\n  border-style: none;\n}\n\n#axwafsbbge p {\n  margin: 0;\n  padding: 0;\n}\n\n#axwafsbbge .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 13px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#axwafsbbge .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#axwafsbbge .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#axwafsbbge .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#axwafsbbge .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#axwafsbbge .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#axwafsbbge .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#axwafsbbge .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#axwafsbbge .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#axwafsbbge .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#axwafsbbge .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#axwafsbbge .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#axwafsbbge .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#axwafsbbge .gt_group_heading {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#axwafsbbge .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#axwafsbbge .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#axwafsbbge .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#axwafsbbge .gt_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#axwafsbbge .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#axwafsbbge .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#axwafsbbge .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#axwafsbbge .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#axwafsbbge .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#axwafsbbge .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#axwafsbbge .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#axwafsbbge .gt_last_summary_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#axwafsbbge .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#axwafsbbge .gt_first_grand_summary_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#axwafsbbge .gt_last_grand_summary_row_top {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#axwafsbbge .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#axwafsbbge .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#axwafsbbge .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#axwafsbbge .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#axwafsbbge .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#axwafsbbge .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#axwafsbbge .gt_left {\n  text-align: left;\n}\n\n#axwafsbbge .gt_center {\n  text-align: center;\n}\n\n#axwafsbbge .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#axwafsbbge .gt_font_normal {\n  font-weight: normal;\n}\n\n#axwafsbbge .gt_font_bold {\n  font-weight: bold;\n}\n\n#axwafsbbge .gt_font_italic {\n  font-style: italic;\n}\n\n#axwafsbbge .gt_super {\n  font-size: 65%;\n}\n\n#axwafsbbge .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#axwafsbbge .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#axwafsbbge .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#axwafsbbge .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#axwafsbbge .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#axwafsbbge .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#axwafsbbge .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#axwafsbbge .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#axwafsbbge div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n  <table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\"><span class='gt_from_md'><strong>Characteristic</strong></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\"><span class='gt_from_md'><strong>Beta</strong></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\"><span class='gt_from_md'><strong>95% CI</strong></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\"><span class='gt_from_md'><strong>p-value</strong></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">(Intercept)</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">51</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">50, 51</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">time</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">-0.35</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">-0.44, -0.27</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"4\"><span class='gt_from_md'>Abbreviation: CI = Confidence Interval</span></td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n</body>",
          "format": "table"
        },
        "type": "output"
      },
      {
        "data": {
          "content": "<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">LMM Model (lme4)</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">SE</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">P-Value</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Intercept</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">50.560</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.115</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Time</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.354</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.044</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td colspan=\"4\" style=\"font-weight:bold; text-align:left; padding-top:.8em;\">Random Effects</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&sigma;<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">37.69</td>\n</tr>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">&tau;<sub>00</sub> <sub>site:family_id:participant_id</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">83.20</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">ICC</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.69</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">N <sub>site</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">22</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">N <sub>family_id</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">7222</td>\n\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">N <sub>participant_id</sub></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">8666</td>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">21256</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.001 / 0.689</td>\n</tr>\n\n</table>\n",
          "format": "table"
        },
        "type": "output"
      },
      {
        "data": {
          "content": "The fixed effects estimates indicate that the average baseline cognition score is 50.560 (SE = 0.115, p < 0.001), with cognition declining by approximately 0.354 points per biannual assessment (Time coefficient = -0.354, SE = 0.044, p < 0.001), confirming a significant negative trajectory over time.The random intercept variance (τ₀₀ = 83.20) suggests substantial individual differences in baseline cognition scores, reinforcing the need to account for between-person variability. The intraclass correlation (ICC = 0.69) indicates that a large proportion (69%) of the total variance in cognition scores is attributable to differences between-individuals rather than within-person fluctuations over time. Since no random slope is included, this model assumes a common rate of cognitive decline across all participants, capturing individual differences only in their starting cognition levels.",
          "title": "Interpretation"
        },
        "type": "note"
      },
      {
        "data": {
          "content": "#  Ensure there are no missing values in site, family_id, or participant_id\ndf_long <- df_long %>%\n  filter(!is.na(site), !is.na(family_id), !is.na(participant_id))  # Remove rows with missing nesting variables\n\n#  Ensure factor levels match those used in model fitting\ndf_long <- df_long %>%\n  mutate(\n    site = factor(site, levels = unique(df_long$site)),\n    family_id = factor(family_id, levels = unique(df_long$family_id)),\n    participant_id = factor(participant_id, levels = unique(df_long$participant_id))\n  )\n\n#  Generate model predictions\ndf_long$predicted_fixed <- predict(model, newdata = df_long, re.form = NA)\n# ✅ Fixed effects only: Represents the overall population-level trajectory\n\ndf_long$predicted_random <- predict(model, newdata = df_long, re.form = ~ (1 | site:family_id:participant_id), allow.new.levels = TRUE)\n# ✅ Includes individual-specific random effects: Allows for variation across participants\n\n#  Select a subset of participant IDs for visualization\nset.seed(321)  # ✅ Set seed for reproducibility\nsample_ids <- sample(unique(df_long$participant_id), size = min(250, length(unique(df_long$participant_id))))  # ✅ Randomly select up to 250 participants\n\n#  Filter dataset to include only sampled participants\ndf_long_sub <- df_long %>%\n    filter(participant_id %in% sample_ids)  # ✅ Retain only selected participant IDs\n\n#  Create the visualization of individual and overall cognition trajectories\nvisualization <- ggplot(df_long_sub, aes(x = time, y = cognition, group = participant_id)) +  # ✅ Use `time` for x-axis\n\n    #  Plot observed data (individual trajectories)\n    geom_line(aes(color = \"Actual Data\"), alpha = 0.3) +\n    geom_point(alpha = 0.3) +\n\n    #  Plot model-predicted values\n    geom_line(aes(y = predicted_random, color = \"Random Intercept\"), alpha = 0.7) +\n    geom_line(aes(y = predicted_fixed, group = 1, color = \"Fixed Effect Mean\"), linewidth = 1.2) +\n\n    #  Customize colors for clarity\n    scale_color_manual(values = c(\n        \"Actual Data\" = \"red\",\n        \"Random Intercept\" = \"grey40\",\n        \"Fixed Effect Mean\" = \"blue\"\n    )) +\n\n    #  Format x-axis labels to reflect `session_id`\n    scale_x_continuous(\n      breaks = 0:3,  # Assuming time is coded as 0,1,2,3\n      labels = c(\"Baseline\", \"Year 2\", \"Year 4\", \"Year 6\")\n    ) +\n\n    #  Add labels and title\n    labs(\n        title = \"Random-Intercept LMM: Individual vs. Overall Cognition Trajectories\",\n        x = \"Assessment Wave\",\n        y = \"Cognition\",\n        color = \"Trajectory Type\"\n    ) +\n\n    #  Apply a minimalistic theme for clarity\n    theme_minimal() +\n    theme(legend.position = \"bottom\")  # ✅ Move legend below the plot\n\n### Display the plot\nvisualization\n\n### Save the plot\nggsave(\n  filename = \"visualization.png\",\n  plot = visualization,\n  width = 8, height = 6, dpi = 300\n)",
          "language": "r",
          "title": "Visualization"
        },
        "type": "code"
      },
      {
        "data": {
          "alt": "Visualization",
          "content": "stage4-artifacts/lmm-random-intercept/visualization.png",
          "format": "image"
        },
        "type": "output"
      },
      {
        "data": {
          "content": "The plot illustrates individual and overall cognition trajectories over time. Red lines represent observed cognition trajectories for each participant, while grey lines show their model-estimated trajectories incorporating random intercepts. The blue line represents the overall fixed-effect mean trajectory, reflecting the population-average trend in cognition from Baseline to Year 6.The vertical spread of lines at each time point highlights substantial individual variability in baseline cognition scores, as participants start at different levels. However, since this model assumes a common rate of change over time, all individuals follow parallel trajectories with different starting points, reinforcing the importance of accounting for between-person differences in initial cognition.",
          "title": "Interpretation"
        },
        "type": "note"
      }
    ]
  },
  "title": "LMM: Random Intercept"
}