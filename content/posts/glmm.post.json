{
  "additional_resources": {
    "cards": [
      {
        "badge": "DOCS",
        "body": "Official CRAN documentation for the lme4 package, covering the glmer() function for fitting generalized linear mixed models with detailed specifications for family distributions and link functions.",
        "title": "lme4 Package Documentation",
        "url": "https://cran.r-project.org/package=lme4"
      },
      {
        "badge": "VIGNETTE",
        "body": "Comprehensive vignette on implementing generalized linear mixed models using lme4, including binary, count, and proportion outcomes with random effects specifications.",
        "title": "Fitting GLMMs in R with lme4",
        "url": "https://cran.r-project.org/web/packages/lme4/vignettes/lmer.pdf"
      },
      {
        "badge": "BOOK",
        "body": "Foundational textbook by Gelman & Hill covering hierarchical models for non-normal outcomes. Chapters 13-14 focus on GLMMs with practical examples and interpretation guidance.",
        "title": "Data Analysis Using Regression and Multilevel Models",
        "url": "https://www.cambridge.org/core/books/data-analysis-using-regression-and-multilevelhierarchical-models/"
      },
      {
        "badge": "TOOL",
        "body": "R package for creating publication-quality tables and plots from mixed models, including predicted probabilities, marginal effects, and random effects visualization.",
        "title": "sjPlot for GLMM Visualization",
        "url": "https://cran.r-project.org/package=sjPlot"
      }
    ]
  },
  "data_access": {
    "items": [
      {
        "content": "<p>ABCD data can be accessed through the <a href=\"https://nbdc.deapscience.com\">DEAP platform</a> or the <a href=\"https://nbdc-datashare.lassoinformatics.com\">NBDC Data Access Platform (LASSO)</a>, which provide user-friendly interfaces for creating custom datasets with point-and-click variable selection. For detailed instructions on accessing and downloading ABCD data, see the <a href=\"https://docs.deapscience.com\">DEAP documentation</a>.</p>\n",
        "open": false,
        "title": "Data Download",
        "type": "collapsible"
      },
      {
        "content": "<p>Once you have downloaded ABCD data files, the <a href=\"https://software.nbdc-datahub.org/NBDCtools/\"><strong>NBDCtools</strong></a> package provides efficient tools for loading and preparing your data for analysis. The package handles common data management tasks including:</p>\n<ul>\n<li><strong>Automatic data joining</strong> - Merges variables from multiple tables automatically</li>\n<li><strong>Built-in transformations</strong> - Converts categorical variables to factors, handles missing data codes, and adds variable labels</li>\n<li><strong>Event filtering</strong> - Easily selects specific assessment waves</li>\n</ul>\n<p>For more information, visit the <a href=\"https://software.nbdc-datahub.org/NBDCtools/\">NBDCtools documentation</a>.</p>\n",
        "open": false,
        "title": "Loading Data with NBDCtools",
        "type": "collapsible"
      },
      {
        "content": "<p>The <code>create_dataset()</code> function is the main tool for loading ABCD data:</p>\n<pre><code class=\"language-r\">library(NBDCtools)\n\n# Define variables needed for this analysis\nrequested_vars &lt;- c(\n  \"var_1\",   # Variable 1\n  \"var_2\",   # Variable 2\n  \"var_3\"    # Variable 3\n)\n\n# Set path to downloaded ABCD data files\ndata_dir &lt;- Sys.getenv(\"ABCD_DATA_PATH\", \"/path/to/abcd/6_0/phenotype\")\n\n# Load data with automatic transformations\nabcd_data &lt;- create_dataset(\n  dir_data = data_dir,\n  study = \"abcd\",\n  vars = requested_vars,\n  release = \"6.0\",\n  format = \"parquet\",\n  categ_to_factor = TRUE,   # Convert categorical variables to factors\n  value_to_na = TRUE,        # Convert missing codes (222, 333, etc.) to NA\n  add_labels = TRUE          # Add variable and value labels\n)\n</code></pre>\n",
        "open": false,
        "title": "Basic Usage",
        "type": "collapsible"
      },
      {
        "content": "<ul>\n<li><strong><code>vars</code></strong> - Vector of variable names to load</li>\n<li><strong><code>release</code></strong> - ABCD data release version (e.g., \"6.0\")</li>\n<li><strong><code>format</code></strong> - File format, typically \"parquet\" for efficiency</li>\n<li><strong><code>categ_to_factor</code></strong> - Automatically converts categorical variables to factors</li>\n<li><strong><code>value_to_na</code></strong> - Converts ABCD missing value codes to R's NA</li>\n<li><strong><code>add_labels</code></strong> - Adds descriptive labels to variables and values</li>\n</ul>\n",
        "open": false,
        "title": "Key Parameters",
        "type": "collapsible"
      },
      {
        "content": "<p>For more details on using NBDCtools:</p>\n<ul>\n<li><a href=\"https://software.nbdc-datahub.org/NBDCtools/articles/NBDCtools.html\">NBDCtools Getting Started Guide</a> - Complete package overview</li>\n<li><a href=\"https://software.nbdc-datahub.org/NBDCtools/articles/join.html\">Joining Data</a> - Advanced data merging strategies</li>\n<li><a href=\"https://software.nbdc-datahub.org/NBDCtools/articles/filter.html\">Filtering Events</a> - Selecting specific assessment waves</li>\n<li><a href=\"https://software.nbdc-datahub.org/NBDCtools/articles/transformation.html\">Data Transformations</a> - Preprocessing and cleaning</li>\n</ul>\n",
        "open": false,
        "title": "Additional NBDCtools Resources",
        "type": "collapsible"
      }
    ]
  },
  "data_preparation": {
    "content_blocks": [
      {
        "data": {
          "content": "### Load necessary libraries\nlibrary(NBDCtools)    # ABCD data access helper\nlibrary(arrow)      # Reading Parquet files\nlibrary(tidyverse)  # Data wrangling & visualization\nlibrary(gtsummary)  # Summary tables\nlibrary(rstatix)    # Tidy-format statistical tests\nlibrary(lme4)       # Linear mixed-effects models (GLMMs)\nlibrary(ggeffects)  # Extract & visualize model predictions\nlibrary(broom)      # Organizing model outputs\nlibrary(broom.mixed)  # Organizing mixed model outputs\n\n### Load harmonized ABCD data required for this analysis\nrequested_vars <- c(\n    \"ab_g_dyn__design_site\",\n    \"ab_g_stc__design_id__fam\",\n    \"su_y_lowuse__isip_001__l\"\n)\n\ndata_dir <- Sys.getenv(\"ABCD_DATA_PATH\", \"/path/to/abcd/6_0/phenotype\")\n\nabcd_data <- create_dataset(\n  dir_data = data_dir,\n  study = \"abcd\",\n  vars = requested_vars,\n  release = \"6.0\",\n  format = \"parquet\",\n  categ_to_factor = TRUE,   # Convert categorical variables to factors\n  value_to_na = TRUE,        # Convert missing codes (222, 333, etc.) to NA\n  add_labels = TRUE          # Add variable and value labels\n)\n\n# Data wrangling: clean, restructure, and filter alcohol use variable\ndf_long <- abcd_data %>%\n  filter(session_id %in% c(\"ses-01A\", \"ses-02A\", \"ses-03A\", \"ses-04A\")) %>%\n  arrange(participant_id, session_id) %>%\n  mutate(\n    id = factor(participant_id),  # Convert participant ID to factor\n    session_id = factor(session_id, levels = c(\"ses-01A\", \"ses-02A\", \"ses-03A\", \"ses-04A\"),\n                   labels = c(\"Year_1\", \"Year_2\", \"Year_3\", \"Year_4\")),  # Rename sessions for clarity\n    time = as.numeric(session_id) - 1,  # Converts factor to 0,1,2,3\n    ab_g_dyn__design_site = factor(ab_g_dyn__design_site),  # Convert site to a factor\n    ab_g_stc__design_id__fam = factor(ab_g_stc__design_id__fam), # Convert family id to a factor\n    alcohol_use = as.numeric(su_y_lowuse__isip_001__l)  # Ensure alcohol use is numeric\n  ) %>%\n  filter(alcohol_use >= 0 & alcohol_use <= 10) %>%  # Keep only valid alcohol use values\n  rename(  # Rename for simplicity\n    site = ab_g_dyn__design_site,\n    family_id = ab_g_stc__design_id__fam,\n  ) %>%\n  # Remove participants with any missing substance use reporting across time points\n  filter(sum(!is.na(alcohol_use)) >= 2) %>%  # Keep only participants with at least 2 non-missing cognition scores\n  ungroup() %>%\n  drop_na(site, family_id, participant_id, alcohol_use)  # Ensure all remaining rows have complete cases",
          "language": "r",
          "title": "Loading and Initial Processing"
        },
        "type": "code"
      },
      {
        "data": {
          "content": "# Create descriptive summary table\ndescriptives_table <- df_long %>%\n  select(session_id, alcohol_use) %>%\n  tbl_summary(\n    by = session_id,\n    missing = \"no\",\n    label = list(alcohol_use ~ \"Alcohol Use\"),\n    statistic = list(all_continuous() ~ \"{mean} ({sd})\")\n  ) %>%\n  modify_header(all_stat_cols() ~ \"**{level}**N = {n}\") %>%\n  modify_spanning_header(all_stat_cols() ~ \"**Assessment Wave**\") %>%\n  bold_labels() %>%\n  italicize_levels()\n\n### Apply compact styling\ntheme_gtsummary_compact()\n\ndescriptives_table <- as_gt(descriptives_table)\n\n### Save the table as HTML\ngt::gtsave(descriptives_table, filename = \"descriptives_table.html\")\n\n### Print the table\ndescriptives_table",
          "language": "r",
          "title": "Descriptive Statistics"
        },
        "type": "code"
      },
      {
        "data": {
          "content": "<div id=\"jsjsiemdhw\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n  <style>#jsjsiemdhw table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#jsjsiemdhw thead, #jsjsiemdhw tbody, #jsjsiemdhw tfoot, #jsjsiemdhw tr, #jsjsiemdhw td, #jsjsiemdhw th {\n  border-style: none;\n}\n\n#jsjsiemdhw p {\n  margin: 0;\n  padding: 0;\n}\n\n#jsjsiemdhw .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 13px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#jsjsiemdhw .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#jsjsiemdhw .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#jsjsiemdhw .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#jsjsiemdhw .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jsjsiemdhw .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jsjsiemdhw .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jsjsiemdhw .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#jsjsiemdhw .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#jsjsiemdhw .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#jsjsiemdhw .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#jsjsiemdhw .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#jsjsiemdhw .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#jsjsiemdhw .gt_group_heading {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#jsjsiemdhw .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#jsjsiemdhw .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#jsjsiemdhw .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#jsjsiemdhw .gt_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#jsjsiemdhw .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jsjsiemdhw .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#jsjsiemdhw .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#jsjsiemdhw .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#jsjsiemdhw .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jsjsiemdhw .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#jsjsiemdhw .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#jsjsiemdhw .gt_last_summary_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jsjsiemdhw .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jsjsiemdhw .gt_first_grand_summary_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#jsjsiemdhw .gt_last_grand_summary_row_top {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jsjsiemdhw .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#jsjsiemdhw .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jsjsiemdhw .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jsjsiemdhw .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jsjsiemdhw .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jsjsiemdhw .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jsjsiemdhw .gt_left {\n  text-align: left;\n}\n\n#jsjsiemdhw .gt_center {\n  text-align: center;\n}\n\n#jsjsiemdhw .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#jsjsiemdhw .gt_font_normal {\n  font-weight: normal;\n}\n\n#jsjsiemdhw .gt_font_bold {\n  font-weight: bold;\n}\n\n#jsjsiemdhw .gt_font_italic {\n  font-style: italic;\n}\n\n#jsjsiemdhw .gt_super {\n  font-size: 65%;\n}\n\n#jsjsiemdhw .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#jsjsiemdhw .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#jsjsiemdhw .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#jsjsiemdhw .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#jsjsiemdhw .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#jsjsiemdhw .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#jsjsiemdhw .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#jsjsiemdhw .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#jsjsiemdhw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n  <table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"label\"><span class='gt_from_md'><strong>Characteristic</strong></span></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"4\" scope=\"colgroup\" id=\"level 1; stat_1\">\n        <div class=\"gt_column_spanner\"><span class='gt_from_md'><strong>Assessment Wave</strong></span></div>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"stat_1\"><span class='gt_from_md'><strong>Year_1</strong>N = 978</span><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"stat_2\"><span class='gt_from_md'><strong>Year_2</strong>N = 991</span><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"stat_3\"><span class='gt_from_md'><strong>Year_3</strong>N = 1090</span><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"stat_4\"><span class='gt_from_md'><strong>Year_4</strong>N = 1533</span><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-weight: bold;\">Alcohol Use</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">1.97 (1.74)</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">2.24 (1.91)</td>\n<td headers=\"stat_3\" class=\"gt_row gt_center\">2.48 (2.02)</td>\n<td headers=\"stat_4\" class=\"gt_row gt_center\">3.03 (2.40)</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"5\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span> <span class='gt_from_md'>Mean (SD)</span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n</body>",
          "format": "table"
        },
        "type": "output"
      }
    ]
  },
  "discussion": {
    "paragraphs": [
      "The Poisson GLMM indicated a clear upward shift in alcohol use: the fixed effect for time was 0.16 on the log scale (p < .001), which translates to an incidence-rate ratio of roughly 1.17 per wave. In practical terms, self-reported drinking frequency increased about 17% each assessment, even after adjusting for repeated measures. Visualizations of the fitted trajectories mirrored this monotonic rise.",
      "Random intercept variance (σ² = 0.187) remained sizable, indicating that youth entered the study with very different baseline propensities that persisted after conditioning on time. Inspecting predicted versus observed counts showed no systemic bias, suggesting the Poisson mean-variance assumption was adequate for these data. Together, the fixed and random effects illustrate how GLMMs can capture both the population trend and the heterogeneity around it, offering a richer story than either a simple Poisson regression or subject-specific regressions could provide."
    ]
  },
  "metadata": {
    "analysis_status": "unknown",
    "author": "Biostatistics Working Group",
    "covariates": "TIC",
    "data_prep_status": "unknown",
    "description": "Build generalized linear mixed models for clustered count data, specify random effects, handle overdispersion, and interpret conditional estimates for ABCD longitudinal outcomes.",
    "execution_time_ms": 4811,
    "method_family": "GLMM",
    "method_family_label": "Generalized Linear Mixed Models (GLMM)",
    "outcome_type": "Count",
    "statistical_engine": "glmmTMB",
    "tags": [
      "abcd-study",
      "glmm",
      "mixed-model"
    ],
    "updated_at": "2025-11-05",
    "validated_at": "2025-11-14T22:37:32.702524+00:00",
    "validator_version": "1.0.0",
    "warnings": 0
  },
  "overview": {
    "features_panel": {
      "items": [
        {
          "heading": "When to Use:",
          "text": "Ideal when you need subject-specific inference for non-Gaussian outcomes collected repeatedly in ABCD."
        },
        {
          "heading": "Key Advantage:",
          "text": "GLMMs combine fixed effects with random intercepts/slopes, delivering both population and subject-level insight for generalized outcomes."
        },
        {
          "heading": "What You'll Learn:",
          "text": "How to fit GLMMs in , interpret fixed/random effects, and evaluate fit/diagnostics for binary/count data."
        }
      ],
      "title": "Features"
    },
    "summary": "Generalized Linear Mixed Models (GLMMs) extend linear mixed models to handle non-normally distributed outcomes such as counts or binary responses while modeling random effects to account for individual differences and hierarchical structures. By combining generalized linear model distributions with random intercepts and slopes, GLMMs capture both population-level trends and person-specific variability in longitudinal data. This tutorial examines alcohol use in ABCD youth across four annual assessments using a Poisson GLMM to model drinking frequency, estimating fixed effects for population trends and random effects for individual variability."
  },
  "statistical_analysis": {
    "content_blocks": [
      {
        "data": {
          "content": "# Fit a Poisson GLMM with random intercepts for site, family, and participant\nmodel <- glmer(\n    alcohol_use ~ time + (1 | site:family_id:participant_id),\n    data = df_long,\n    family = poisson(link = \"log\"),\n    control = glmerControl(optimizer = \"bobyqa\")\n)\n\n# Generate a summary table for the GLMM model\nmodel_summary_table <- gtsummary::tbl_regression(model,\n    digits = 3,\n    intercept = TRUE\n) %>%\n  gtsummary::as_gt()\n\n# Display model summary (optional)\nmodel_summary_table\n\n### Save the gt table\ngt::gtsave(\n  data = model_summary_table,\n  filename = \"model_summary.html\",\n  inline_css = FALSE\n)",
          "language": "r",
          "title": "Fit Model"
        },
        "type": "code"
      },
      {
        "data": {
          "content": "<div id=\"gevuvodvsy\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n  <style>#gevuvodvsy table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#gevuvodvsy thead, #gevuvodvsy tbody, #gevuvodvsy tfoot, #gevuvodvsy tr, #gevuvodvsy td, #gevuvodvsy th {\n  border-style: none;\n}\n\n#gevuvodvsy p {\n  margin: 0;\n  padding: 0;\n}\n\n#gevuvodvsy .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 13px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#gevuvodvsy .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#gevuvodvsy .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#gevuvodvsy .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#gevuvodvsy .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gevuvodvsy .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gevuvodvsy .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gevuvodvsy .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#gevuvodvsy .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#gevuvodvsy .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#gevuvodvsy .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#gevuvodvsy .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#gevuvodvsy .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#gevuvodvsy .gt_group_heading {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#gevuvodvsy .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#gevuvodvsy .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#gevuvodvsy .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#gevuvodvsy .gt_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#gevuvodvsy .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gevuvodvsy .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#gevuvodvsy .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#gevuvodvsy .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#gevuvodvsy .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gevuvodvsy .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#gevuvodvsy .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#gevuvodvsy .gt_last_summary_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gevuvodvsy .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gevuvodvsy .gt_first_grand_summary_row {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#gevuvodvsy .gt_last_grand_summary_row_top {\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gevuvodvsy .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#gevuvodvsy .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gevuvodvsy .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gevuvodvsy .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gevuvodvsy .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gevuvodvsy .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 1px;\n  padding-bottom: 1px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gevuvodvsy .gt_left {\n  text-align: left;\n}\n\n#gevuvodvsy .gt_center {\n  text-align: center;\n}\n\n#gevuvodvsy .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#gevuvodvsy .gt_font_normal {\n  font-weight: normal;\n}\n\n#gevuvodvsy .gt_font_bold {\n  font-weight: bold;\n}\n\n#gevuvodvsy .gt_font_italic {\n  font-style: italic;\n}\n\n#gevuvodvsy .gt_super {\n  font-size: 65%;\n}\n\n#gevuvodvsy .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#gevuvodvsy .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#gevuvodvsy .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#gevuvodvsy .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#gevuvodvsy .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#gevuvodvsy .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#gevuvodvsy .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#gevuvodvsy .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#gevuvodvsy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n  <table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\"><span class='gt_from_md'><strong>Characteristic</strong></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\"><span class='gt_from_md'><strong>log(IRR)</strong></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\"><span class='gt_from_md'><strong>95% CI</strong></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\"><span class='gt_from_md'><strong>p-value</strong></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">(Intercept)</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.51</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.46, 0.55</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">time</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.16</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.14, 0.18</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"4\"><span class='gt_from_md'>Abbreviations: CI = Confidence Interval, IRR = Incidence Rate Ratio</span></td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n</body>",
          "format": "table"
        },
        "type": "output"
      },
      {
        "data": {
          "content": "# Extract random effects variance and model diagnostics\nre_var <- as.data.frame(VarCorr(model))\n\n# Create diagnostics table\ndiagnostics_data <- data.frame(\n  Diagnostic = c(\n    \"Family\",\n    \"Link Function\",\n    \"Random Intercept Variance (σ²)\",\n    \"Number of Participants\",\n    \"Total Observations\"\n  ),\n  Value = c(\n    \"Poisson\",\n    \"log\",\n    sprintf(\"%.4f\", re_var$vcov[1]),\n    sprintf(\"%d\", length(unique(df_long$participant_id))),\n    sprintf(\"%d\", nrow(df_long))\n  )\n)\n\n# Create gt table\ndiagnostics_table <- diagnostics_data %>%\n  gt::gt() %>%\n  gt::tab_header(title = \"GLMM Model Diagnostics\") %>%\n  gt::cols_label(\n    Diagnostic = gt::md(\"**Diagnostic**\"),\n    Value = gt::md(\"**Value**\")\n  ) %>%\n  gt::tab_options(table.font.size = 12)\n\n# Save diagnostics table\ngt::gtsave(diagnostics_table, filename = \"model_diagnostics.html\")\n\n# Display table\ndiagnostics_table",
          "language": "r",
          "title": "Model Diagnostics"
        },
        "type": "code"
      },
      {
        "data": {
          "content": "<div id=\"pplghjzunw\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n  <style>#pplghjzunw table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#pplghjzunw thead, #pplghjzunw tbody, #pplghjzunw tfoot, #pplghjzunw tr, #pplghjzunw td, #pplghjzunw th {\n  border-style: none;\n}\n\n#pplghjzunw p {\n  margin: 0;\n  padding: 0;\n}\n\n#pplghjzunw .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 12px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#pplghjzunw .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#pplghjzunw .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#pplghjzunw .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#pplghjzunw .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pplghjzunw .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pplghjzunw .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pplghjzunw .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#pplghjzunw .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#pplghjzunw .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#pplghjzunw .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#pplghjzunw .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#pplghjzunw .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#pplghjzunw .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#pplghjzunw .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#pplghjzunw .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#pplghjzunw .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#pplghjzunw .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#pplghjzunw .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pplghjzunw .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#pplghjzunw .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#pplghjzunw .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#pplghjzunw .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pplghjzunw .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#pplghjzunw .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#pplghjzunw .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pplghjzunw .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pplghjzunw .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#pplghjzunw .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pplghjzunw .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#pplghjzunw .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pplghjzunw .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pplghjzunw .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pplghjzunw .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pplghjzunw .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pplghjzunw .gt_left {\n  text-align: left;\n}\n\n#pplghjzunw .gt_center {\n  text-align: center;\n}\n\n#pplghjzunw .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#pplghjzunw .gt_font_normal {\n  font-weight: normal;\n}\n\n#pplghjzunw .gt_font_bold {\n  font-weight: bold;\n}\n\n#pplghjzunw .gt_font_italic {\n  font-style: italic;\n}\n\n#pplghjzunw .gt_super {\n  font-size: 65%;\n}\n\n#pplghjzunw .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#pplghjzunw .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#pplghjzunw .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#pplghjzunw .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#pplghjzunw .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#pplghjzunw .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#pplghjzunw .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#pplghjzunw .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#pplghjzunw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n  <table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>GLMM Model Diagnostics</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Diagnostic\"><span class='gt_from_md'><strong>Diagnostic</strong></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Value\"><span class='gt_from_md'><strong>Value</strong></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Diagnostic\" class=\"gt_row gt_left\">Family</td>\n<td headers=\"Value\" class=\"gt_row gt_left\">Poisson</td></tr>\n    <tr><td headers=\"Diagnostic\" class=\"gt_row gt_left\">Link Function</td>\n<td headers=\"Value\" class=\"gt_row gt_left\">log</td></tr>\n    <tr><td headers=\"Diagnostic\" class=\"gt_row gt_left\">Random Intercept Variance (σ²)</td>\n<td headers=\"Value\" class=\"gt_row gt_left\">0.1868</td></tr>\n    <tr><td headers=\"Diagnostic\" class=\"gt_row gt_left\">Number of Participants</td>\n<td headers=\"Value\" class=\"gt_row gt_left\">2912</td></tr>\n    <tr><td headers=\"Diagnostic\" class=\"gt_row gt_left\">Total Observations</td>\n<td headers=\"Value\" class=\"gt_row gt_left\">4592</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n</body>",
          "format": "table"
        },
        "type": "output"
      },
      {
        "data": {
          "content": "The Poisson GLMM results indicate a significant increase in alcohol use over time, with the time coefficient of 0.16 (log-scale, 95% CI: 0.14, 0.18, p < 0.001) suggesting an upward trend in consumption across assessments. This corresponds to an incidence rate ratio (IRR) of approximately 1.17 (exp(0.16) ≈ 1.17), meaning alcohol use increases by approximately 17% per assessment wave.The random intercept variance (σ² = 0.1868) highlights moderate individual differences in baseline alcohol use, reinforcing the importance of accounting for between-person variability.Model fit metrics, including the log-likelihood value, suggest that the GLMM provides a well-suited framework for capturing both population-wide trends and subject-specific differences in alcohol consumption over time.",
          "title": "Interpretation"
        },
        "type": "note"
      },
      {
        "data": {
          "content": "# Get predicted alcohol use by time\npreds <- ggeffect(model, terms = \"time\")\n\n# Plot predicted probabilities with confidence intervals\nggplot(preds, aes(x = x, y = predicted)) +\n  geom_point(size = 3, color = \"blue\") +\n  geom_line(group = 1, color = \"blue\") +\n  geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.2) +\n  labs(title = \"Predicted Alcohol Use by time\",\n       x = \"time (Timepoint)\",\n       y = \"Predicted Alcohol Use\") +\n  theme_minimal()\n\n  df_long$predicted <- predict(model, type = \"response\")\n\nvisualization <- ggplot(df_long, aes(x = predicted, y = alcohol_use)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", color = \"red\", se = FALSE) +\n  labs(title = \"Predicted vs. Observed Alcohol Use\",\n       x = \"Predicted Alcohol Use\",\n       y = \"Observed Alcohol Use\") +\n  theme_minimal()\n\n# Display the plot\nvisualization\n\n# Save the plot\nggsave(\n  filename = \"visualization.png\",\n  plot = visualization,\n  width = 8, height = 6, dpi = 300\n)",
          "language": "r",
          "title": "Visualize"
        },
        "type": "code"
      },
      {
        "data": {
          "alt": "Visualization",
          "content": "/stage4-artifacts/glmm/visualization.png",
          "format": "image"
        },
        "type": "output"
      },
      {
        "data": {
          "content": "The predicted trajectories indicate a steady increase in alcohol use across assessment waves, reflecting an overall upward trend in consumption over time. While the population-level pattern suggests consistent growth, individual trajectories vary, highlighting differences in baseline alcohol use and rates of change. This variability underscores the importance of accounting for both fixed effects (overall trends) and random effects (subject-specific deviations) in modeling alcohol use trajectories.",
          "title": "Visualization Notes"
        },
        "type": "note"
      }
    ]
  },
  "title": "GLMM: Basic"
}