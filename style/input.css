@import "tailwindcss";
@plugin "@tailwindcss/typography";

@source "./src/**/*.rs";

/* Safelist dynamically-generated syntax highlighting classes (from syntax_highlight.rs) */
@source inline("syn-comment syn-string syn-number syn-keyword syn-function syn-type syn-variable syn-operator syn-punctuation");

/* Configure dark: variant to work with data-theme="dark" OR data-theme="dracula" */
@variant dark (:is([data-theme="dark"], [data-theme="dracula"]) &);

/* Design Tokens - Dark-mode ready structure */
@theme {
  /* ========================================
     SPACING SCALE
     ======================================== */
  --spacing-1: 0.25rem;   /* 4px  - tight elements */
  --spacing-2: 0.5rem;    /* 8px  - inline spacing */
  --spacing-3: 0.75rem;   /* 12px - default gap */
  --spacing-4: 1rem;      /* 16px - comfortable */
  --spacing-5: 1.25rem;   /* 20px - medium-large */
  --spacing-6: 1.5rem;    /* 24px - container padding */
  --spacing-8: 2rem;      /* 32px - large spacing */
  --spacing-10: 2.5rem;   /* 40px - extra large */
  --spacing-12: 3rem;     /* 48px - section vertical */
  --spacing-16: 4rem;     /* 64px - section separation */

  /* ========================================
     BORDER RADIUS
     ======================================== */
  --radius-sm: 0.375rem;  /* 6px */
  --radius-md: 0.5rem;    /* 8px */
  --radius-lg: 0.75rem;   /* 12px */
  --radius-xl: 1rem;      /* 16px */
  --radius-2xl: 1.5rem;   /* 24px */
  --radius-3xl: 2rem;     /* 32px */
  --radius-full: 9999px;

  /* Semantic radius aliases */
  --radius-container: var(--radius-2xl);
  --radius-panel: var(--radius-xl);
  --radius-pill: var(--radius-full);

  /* ========================================
     SHADOWS - Minimal elevation scheme
     ======================================== */
  --shadow-xs: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.1);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);

  /* ========================================
     NEUTRAL PALETTE (Cool slate grays)
     Slightly cooler tone for modern, technical aesthetic
     ======================================== */
  --color-neutral-50: #f8fafc;
  --color-neutral-100: #f1f5f9;
  --color-neutral-200: #e2e8f0;
  --color-neutral-300: #cbd5e1;
  --color-neutral-400: #94a3b8;
  --color-neutral-500: #64748b;
  --color-neutral-600: #475569;
  --color-neutral-700: #334155;
  --color-neutral-800: #1e293b;
  --color-neutral-900: #0f172a;

  /* ========================================
     ACCENT PALETTE (Teal/Cyan - Modern Data Science)
     Professional teal for research and technical content
     ======================================== */
  --color-accent-50: #ecfeff;
  --color-accent-100: #cffafe;
  --color-accent-200: #a5f3fc;
  --color-accent-300: #67e8f9;
  --color-accent-400: #22d3ee;
  --color-accent-500: #06b6d4;
  --color-accent-600: #0891b2;
  --color-accent-700: #0e7490;

  /* ========================================
     INFO TONE (Cyan - for informational callouts)
     ======================================== */
  --color-info-50: #ecfeff;
  --color-info-300: #67e8f9;
  --color-info-500: #06b6d4;

  /* ========================================
     WARNING TONE (Amber - for warning callouts)
     ======================================== */
  --color-warning-50: #fffbeb;
  --color-warning-100: #fef3c7;
  --color-warning-300: #fcd34d;
  --color-warning-500: #f59e0b;
  --color-warning-700: #b45309;

  /* ========================================
     SUCCESS TONE (Green - for success states, validation)
     ======================================== */
  --color-success-50: #f0fdf4;
  --color-success-100: #dcfce7;
  --color-success-300: #86efac;
  --color-success-500: #22c55e;
  --color-success-700: #15803d;

  /* ========================================
     ERROR/DANGER TONE (Red - for errors, required fields, validation)
     ======================================== */
  --color-error-50: #fef2f2;
  --color-error-100: #fee2e2;
  --color-error-300: #fca5a5;
  --color-error-500: #ef4444;
  --color-error-700: #b91c1c;

  /* ========================================
     SEMANTIC ALIASES - Light mode
     Dark mode would reassign these to inverted values
     ======================================== */

  /* Text colors */
  --color-text-primary: var(--color-neutral-900);
  --color-text-secondary: var(--color-neutral-600);
  --color-text-tertiary: var(--color-neutral-500);
  --color-text-muted: var(--color-neutral-600); /* Changed from 500 to 600 for WCAG AA compliance (7.5:1 contrast) */
  --color-text-accent: var(--color-accent-600);

  /* Background colors */
  --color-bg-surface: #ffffff;
  --color-bg-subtle: var(--color-neutral-50);
  --color-bg-accent: var(--color-accent-500);
  --color-bg-accent-subtle: var(--color-accent-100);

  /* Border colors */
  --color-border-default: var(--color-neutral-300);
  --color-border-subtle: var(--color-neutral-200);
  --color-border-accent: var(--color-accent-500);

  /* State-specific semantic colors */
  --color-text-success: var(--color-success-700);
  --color-text-warning: var(--color-warning-700);
  --color-text-error: var(--color-error-700);
  --color-bg-success: var(--color-success-50);
  --color-bg-warning: var(--color-warning-50);
  --color-bg-error: var(--color-error-50);
  --color-border-success: var(--color-success-500);
  --color-border-warning: var(--color-warning-500);
  --color-border-error: var(--color-error-500);

  /* Focus ring variants for different states */
  --color-focus-ring: var(--color-accent-500);
  --color-focus-ring-success: var(--color-success-500);
  --color-focus-ring-warning: var(--color-warning-500);
  --color-focus-ring-error: var(--color-error-500);

  /* ========================================
     TYPOGRAPHY SCALE (Responsive with clamp())
     Fluid typography that scales between min and max viewport sizes
     ======================================== */

  /* Font Sizes - Responsive with clamp(min, preferred, max)
     Scales fluidly between mobile (320px) and desktop (1920px) viewports */
  --font-size-post-title: clamp(1.75rem, 1.5rem + 1.25vw, 2.5rem);      /* 28px → 40px - Main post title */
  --font-size-section-title: clamp(1.25rem, 1.125rem + 0.625vw, 1.75rem); /* 20px → 28px - H1 section headings */
  --font-size-panel-title: clamp(1rem, 0.95rem + 0.25vw, 1.25rem);      /* 16px → 20px - H2/H3 panel headings */
  --font-size-body: clamp(1rem, 0.97rem + 0.15vw, 1.125rem);            /* 16px → 18px - Regular paragraph text */
  --font-size-supporting: clamp(0.813rem, 0.8rem + 0.0625vw, 0.875rem); /* 13px → 14px - Secondary/metadata text */
  --font-size-stat-value: clamp(0.875rem, 0.85rem + 0.125vw, 1rem);     /* 14px → 16px - Stat values */

  /* Line Heights */
  --leading-tight: 1.25;                /* For headings and titles */
  --leading-normal: 1.5;                /* For body text (default) */
  --leading-relaxed: 1.75;              /* For long-form prose */
  --leading-longform: 1.8;              /* For extended reading (Discussion, Overview) */

  /* Font Weights */
  --font-weight-regular: 400;           /* Normal text */
  --font-weight-medium: 500;            /* Emphasized text */
  --font-weight-semibold: 600;          /* Headings and titles */

  /* ========================================
     ASIDE/NAVIGATION COMPONENTS
     Dark background matching left nav (slate-800/95)
     ======================================== */

  /* Aside backgrounds - matches left nav for visual consistency */
  --color-aside-bg: rgba(30, 41, 59, 0.95);          /* slate-800 at 95% opacity - matches left nav */
  --color-aside-bg-solid: rgb(30, 41, 59);           /* Solid slate-800 background */
  --color-aside-border: rgba(51, 65, 85, 0.5);       /* slate-700 at 50% opacity - matches left nav border */
  --color-aside-border-accent: rgba(51, 65, 85, 0.5); /* Consistent border for dividers */

  /* Aside text colors - lighter for dark backgrounds */
  --color-aside-text-primary: rgb(226, 232, 240);    /* neutral-200 - high contrast on dark */
  --color-aside-text-secondary: rgb(148, 163, 184);  /* neutral-400 - readable secondary */
  --color-aside-text-muted: rgba(148, 163, 184, 0.8); /* neutral-400/80 - subtle text */

  /* Aside interaction states */
  --color-aside-hover-bg: rgba(51, 65, 85, 0.2);     /* Subtle hover background */
  --color-aside-hover-text: var(--color-accent-300); /* Teal accent on hover */
  --color-aside-hover-border: rgba(6, 182, 212, 0.2); /* Accent border on hover */

  /* Aside active/selected states */
  --color-aside-active-bg: rgba(6, 182, 212, 0.1);   /* Subtle teal background */
  --color-aside-active-border: var(--color-accent-400); /* Teal border */

  /* ========================================
     CODE BLOCK COLORS - Semantic tokens
     Dark theme with teal accent
     ======================================== */
  --color-code-bg: rgb(15, 23, 42);                   /* slate-900 - dark background */
  --color-code-border: var(--color-accent-500);       /* teal accent border */
  --color-code-text: var(--color-neutral-100);        /* light text on dark */

  /* ========================================
     INTERACTIVE CARD TOKENS
     For resource cards, tool cards, and similar interactive surfaces
     ======================================== */

  /* Card structure */
  --card-radius: var(--radius-2xl);                   /* 24px - consistent rounded corners */
  --card-padding: var(--spacing-4);                   /* 16px - internal padding */
  --card-padding-lg: var(--spacing-6);                /* 24px - larger card padding */
  --card-gap: var(--spacing-6);                       /* 24px - grid gap between cards */

  /* Card colors */
  --card-bg: var(--color-bg-surface);                 /* White surface */
  --card-bg-hover: var(--color-bg-surface);           /* Same on hover (shadow provides depth) */
  --card-border: var(--color-border-default);         /* Default border */
  --card-border-hover: var(--color-accent-500);       /* Accent on hover */

  /* Card shadows */
  --card-shadow: var(--shadow-xs);                    /* Subtle resting shadow */
  --card-shadow-hover: 0 10px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1); /* Elevated on hover */

  /* Card transitions */
  --card-transition: 200ms ease;                      /* Smooth, not too fast */

  /* Card focus ring */
  --card-focus-ring: var(--color-focus-ring);         /* Accent color */
  --card-focus-ring-offset: 2px;                      /* Offset from card edge */
  --card-focus-ring-width: 2px;                       /* Ring thickness */

  /* Media container (for logos, covers) */
  --card-media-bg: var(--color-bg-subtle);            /* Subtle background for media areas */
  --card-media-radius: var(--radius-xl);              /* Slightly smaller than card */
}

/* ========================================
   DARK THEME
   Inverts light theme using slate/teal palette
   ======================================== */
[data-theme="dark"] {
  /* Semantic color overrides - flip light/dark values */
  --color-text-primary: var(--color-neutral-100);
  --color-text-secondary: var(--color-neutral-400);
  --color-text-tertiary: var(--color-neutral-500);
  --color-text-muted: var(--color-neutral-500);
  --color-text-accent: var(--color-accent-400);

  /* Background colors - darker tones */
  --color-bg-surface: var(--color-neutral-900);
  --color-bg-subtle: var(--color-neutral-800);
  --color-bg-accent: var(--color-accent-600);
  --color-bg-accent-subtle: rgba(6, 182, 212, 0.15);

  /* Border colors - lighter than background for visibility */
  --color-border-default: var(--color-neutral-700);
  --color-border-subtle: var(--color-neutral-800);
  --color-border-accent: var(--color-accent-500);

  /* State colors - darker backgrounds, lighter text */
  --color-text-success: var(--color-success-300);
  --color-text-warning: var(--color-warning-300);
  --color-text-error: var(--color-error-300);
  --color-bg-success: rgba(34, 197, 94, 0.15);
  --color-bg-warning: rgba(245, 158, 11, 0.15);
  --color-bg-error: rgba(239, 68, 68, 0.15);
  --color-border-success: var(--color-success-500);
  --color-border-warning: var(--color-warning-500);
  --color-border-error: var(--color-error-500);

  /* Focus rings - brighter for dark backgrounds */
  --color-focus-ring: var(--color-accent-400);
  --color-focus-ring-success: var(--color-success-400);
  --color-focus-ring-warning: var(--color-warning-400);
  --color-focus-ring-error: var(--color-error-400);

  /* Aside/nav - slightly lighter than body for contrast */
  --color-aside-bg: rgba(51, 65, 85, 0.95);
  --color-aside-bg-solid: rgb(51, 65, 85);
  --color-aside-border: rgba(71, 85, 105, 0.5);
  --color-aside-border-accent: rgba(71, 85, 105, 0.5);
  --color-aside-text-primary: rgb(241, 245, 249);
  --color-aside-text-secondary: rgb(148, 163, 184);
  --color-aside-text-muted: rgba(148, 163, 184, 0.8);
  --color-aside-hover-bg: rgba(71, 85, 105, 0.3);
  --color-aside-hover-text: var(--color-accent-300);
  --color-aside-hover-border: rgba(6, 182, 212, 0.3);
  --color-aside-active-bg: rgba(6, 182, 212, 0.15);
  --color-aside-active-border: var(--color-accent-400);

  /* Code blocks - even darker than body */
  --color-code-bg: rgb(15, 23, 42);
  --color-code-border: var(--color-accent-500);
  --color-code-text: var(--color-neutral-100);

  /* Shadows - softer for dark backgrounds */
  --shadow-xs: 0 1px 2px 0 rgb(0 0 0 / 0.3);
  --shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.4);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.5);

  /* Card tokens - dark mode */
  --card-bg: var(--color-bg-surface);
  --card-bg-hover: var(--color-bg-surface);
  --card-border: var(--color-border-default);
  --card-border-hover: var(--color-accent-400);
  --card-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.3);
  --card-shadow-hover: 0 10px 25px -5px rgb(0 0 0 / 0.4), 0 8px 10px -6px rgb(0 0 0 / 0.3);
  --card-media-bg: var(--color-bg-subtle);

  /* Icon filters - invert dark icons for visibility on dark backgrounds */
  .download-btn-icon--invert {
    filter: brightness(0) invert(0.9);
  }
}

/* ========================================
   DRACULA THEME
   Full Dracula color palette
   ======================================== */
[data-theme="dracula"] {
  /* Dracula color palette */
  --color-neutral-50: #f8f8f2;   /* Dracula foreground */
  --color-neutral-100: #f8f8f2;
  --color-neutral-200: #e2e2e2;
  --color-neutral-300: #a0a0a0;
  --color-neutral-400: #6272a4;  /* Dracula comment */
  --color-neutral-500: #6272a4;
  --color-neutral-600: #44475a;  /* Dracula current line */
  --color-neutral-700: #44475a;
  --color-neutral-800: #282a36;  /* Dracula background */
  --color-neutral-900: #21222c;  /* Darker than Dracula BG */

  /* Dracula accent colors */
  --color-accent-50: #f0f9ff;
  --color-accent-100: #d8f0ff;
  --color-accent-200: #b3e0ff;
  --color-accent-300: #8be9fd;   /* Dracula cyan */
  --color-accent-400: #8be9fd;
  --color-accent-500: #8be9fd;
  --color-accent-600: #50fa7b;   /* Dracula green */
  --color-accent-700: #50fa7b;

  /* Dracula state colors */
  --color-info-50: #f0f9ff;
  --color-info-300: #8be9fd;     /* Cyan */
  --color-info-500: #8be9fd;

  --color-warning-50: #fffbeb;
  --color-warning-100: #fef3c7;
  --color-warning-300: #ffb86c;  /* Orange */
  --color-warning-500: #ffb86c;
  --color-warning-700: #ff8c3a;

  --color-success-50: #f0fdf4;
  --color-success-100: #dcfce7;
  --color-success-300: #50fa7b;  /* Green */
  --color-success-500: #50fa7b;
  --color-success-700: #2dd45f;

  --color-error-50: #fef2f2;
  --color-error-100: #fee2e2;
  --color-error-300: #ff5555;    /* Red */
  --color-error-500: #ff5555;
  --color-error-700: #ff0000;

  /* Semantic color mappings */
  --color-text-primary: #f8f8f2;
  --color-text-secondary: #6272a4;
  --color-text-tertiary: #6272a4;
  --color-text-muted: #6272a4;
  --color-text-accent: #8be9fd;

  /* Background colors */
  --color-bg-surface: #282a36;
  --color-bg-subtle: #44475a;
  --color-bg-accent: #8be9fd;
  --color-bg-accent-subtle: rgba(139, 233, 253, 0.15);

  /* Border colors */
  --color-border-default: #6272a4;
  --color-border-subtle: #44475a;
  --color-border-accent: #bd93f9;  /* Dracula purple */

  /* State semantic colors */
  --color-text-success: #50fa7b;
  --color-text-warning: #ffb86c;
  --color-text-error: #ff5555;
  --color-bg-success: rgba(80, 250, 123, 0.15);
  --color-bg-warning: rgba(255, 184, 108, 0.15);
  --color-bg-error: rgba(255, 85, 85, 0.15);
  --color-border-success: #50fa7b;
  --color-border-warning: #ffb86c;
  --color-border-error: #ff5555;

  /* Focus rings */
  --color-focus-ring: #bd93f9;
  --color-focus-ring-success: #50fa7b;
  --color-focus-ring-warning: #ffb86c;
  --color-focus-ring-error: #ff5555;

  /* Aside/nav - use current line color */
  --color-aside-bg: rgba(68, 71, 90, 0.95);
  --color-aside-bg-solid: rgb(68, 71, 90);
  --color-aside-border: rgba(98, 114, 164, 0.5);
  --color-aside-border-accent: rgba(189, 147, 249, 0.3);
  --color-aside-text-primary: #f8f8f2;
  --color-aside-text-secondary: #8be9fd;
  --color-aside-text-muted: rgba(139, 233, 253, 0.7);
  --color-aside-hover-bg: rgba(98, 114, 164, 0.3);
  --color-aside-hover-text: #bd93f9;
  --color-aside-hover-border: rgba(189, 147, 249, 0.5);
  --color-aside-active-bg: rgba(189, 147, 249, 0.15);
  --color-aside-active-border: #bd93f9;

  /* Code blocks */
  --color-code-bg: #282a36;
  --color-code-border: #bd93f9;
  --color-code-text: #f8f8f2;

  /* Shadows - subtle for dark theme */
  --shadow-xs: 0 1px 2px 0 rgb(0 0 0 / 0.4);
  --shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.5);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.6);

  /* Card tokens - Dracula */
  --card-bg: var(--color-bg-surface);
  --card-bg-hover: var(--color-bg-surface);
  --card-border: var(--color-border-default);
  --card-border-hover: #bd93f9;  /* Dracula purple */
  --card-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.4);
  --card-shadow-hover: 0 10px 25px -5px rgb(0 0 0 / 0.5), 0 8px 10px -6px rgb(0 0 0 / 0.4);
  --card-media-bg: var(--color-bg-subtle);

  /* Icon filters - invert dark icons with purple tint for Dracula aesthetic */
  .download-btn-icon--invert {
    filter: brightness(0) invert(0.95) sepia(0.15) hue-rotate(200deg);
  }
}

/* ========================================
   GLOBAL PAGE STYLING
   Apply theme colors to entire page
   ======================================== */
html {
  background-color: var(--color-bg-surface);
  color: var(--color-text-primary);
}

body {
  background-color: var(--color-bg-surface);
  color: var(--color-text-primary);
  min-height: 100vh;
}

/* Minimal structural hooks; feel free to replace with utilities later */
  .post {
    display: grid;
    gap: var(--spacing-6);
  }
.post__title-container {
  margin-block-end: var(--spacing-4);
}

/* Tutorial hero/header */
.post-hero {
  padding-top: var(--spacing-4);
  padding-bottom: var(--spacing-4);
  border-bottom: 1px solid var(--color-border-default);
  background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
}

.post-hero__content {
  max-width: 64rem;
  margin: 0 auto;
  display: flex;
  flex-direction: column;
  gap: var(--spacing-3);
}

.post-hero__breadcrumb {
  font-size: 0.9rem;
  color: var(--color-text-muted);
}

.post-hero__summary {
  font-size: 1rem;
  color: var(--color-text-secondary);
  margin-top: var(--spacing-2);
}

.post-hero__actions {
  position: absolute;
  top: var(--spacing-4);
  right: var(--spacing-6);
}

@media (max-width: 1023px) {
  .post-hero__actions {
    position: static;
    margin-top: var(--spacing-3);
    display: flex;
    justify-content: flex-end;
  }
}
.section {
  display: grid;
  gap: var(--spacing-3);
}
.section__title {
  font-size: 1.25rem;
}
.section__content {
  display: grid;
  gap: var(--spacing-2);
}

@layer components {
  /* ========================================
     CONTAINER COMPONENTS
     ======================================== */

  /* Primary container - elevated card with responsive padding */
  .card {
    border-radius: var(--radius-container);
    /* border: 1px solid var(--color-border-default); */
    border-left: 3px solid var(--color-border-accent);
    padding: var(--spacing-6); /* Mobile: 24px (--spacing-6) */
    box-shadow: var(--shadow-sm);
    background-color: var(--color-bg-surface);
  }

  /* Tablet and desktop: increase card padding for more breathing room */
  @media (min-width: 768px) {
    .card {
      padding: var(--spacing-6); /* Tablet: maintain 24px */
    }
  }

  @media (min-width: 1024px) {
    .card {
      padding: var(--spacing-8); /* Desktop: 32px (--spacing-8) */
    }
  }

  /* Nested cards - regular borders without accent */
  .card .card {
    border: 1px solid var(--color-border-default);
    border-left: 1px solid var(--color-border-default); /* Override accent */
  }

  /* Code blocks in nested cards - remove accent border */
  .card .card pre {
    border-left: 1px solid var(--color-border-default);
  }

  /* Secondary container - flat panel */
  .panel {
    border-radius: var(--radius-panel);
    border: 1px solid var(--color-border-default);
    padding: var(--spacing-5);
    background-color: var(--color-bg-surface);
  }

  /* Callout/note box with accent border */
  .callout {
    border-radius: var(--radius-lg);
    border-left: 4px solid var(--color-border-accent);
    padding: var(--spacing-4);
    background-color: var(--color-bg-accent-subtle);
  }

  /* Tone-specific callouts */
  .tone-info {
    border-color: var(--color-info-300);
    background-color: var(--color-info-50);
  }

  .tone-warning {
    border-color: var(--color-warning-300);
    background-color: var(--color-warning-50);
  }

  /* ========================================
     CALLOUT MODIFIERS - Semantic Variants
     ======================================== */

  /* Interpretation callout - for statistical analysis notes */
  .callout--interpretation {
    background: var(--color-info-50);
    border-color: var(--color-info-500);
    padding: var(--spacing-6);
    color: var(--color-neutral-900);
  }

  /* Icon container for interpretation callouts */
  .callout--interpretation .icon-circle {
    width: 2.5rem;       /* 40px - h-10 equivalent */
    height: 2.5rem;      /* 40px - w-10 equivalent */
    background: var(--color-info-500);
    border-radius: var(--radius-full);
  }

  .callout--interpretation .icon-circle svg {
    stroke: white;
  }

  .callout--interpretation .body-text,
  .callout--interpretation p {
    color: inherit;
  }

  [data-theme="dark"] .callout--interpretation,
  [data-theme="dracula"] .callout--interpretation {
    background: rgba(139, 233, 253, 0.12);
    border-color: rgba(139, 233, 253, 0.7);
    color: var(--color-neutral-50);
  }

  [data-theme="dark"] .callout--interpretation .body-text,
  [data-theme="dark"] .callout--interpretation p,
  [data-theme="dracula"] .callout--interpretation .body-text,
  [data-theme="dracula"] .callout--interpretation p {
    color: inherit;
  }

  /* ========================================
     DISCUSSION PULL QUOTE
     ======================================== */

  /* .discussion-pull-quote removed - not used in current implementation */

  /* ========================================
     CARD HOVER UTILITY - Interactive Depth Effect
     Adds elevation and subtle scale on hover/focus for interactive cards
     ======================================== */

  .card-hover {
    transition: transform 180ms ease, box-shadow 180ms ease;
  }

  .card-hover:hover,
  .card-hover:focus-within {
    transform: translateY(-2px) scale(1.01);
    box-shadow: var(--shadow-md);
  }

  @media (prefers-reduced-motion: reduce) {
    .card-hover,
    .card-hover:hover,
    .card-hover:focus-within {
      transform: none;
    }
  }

  /* ========================================
     RESOURCE CARD - Interactive card for Resources/Tools pages
     Uses card design tokens for consistent styling
     ======================================== */

  .resource-card {
    display: flex;
    flex-direction: column;
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    box-shadow: var(--card-shadow);
    overflow: hidden;
    transition:
      border-color var(--card-transition),
      box-shadow var(--card-transition),
      transform var(--card-transition);
  }

  .resource-card:hover {
    border-color: var(--card-border-hover);
    box-shadow: var(--card-shadow-hover);
    transform: translateY(-2px);
  }

  .resource-card:focus-visible {
    outline: none;
    border-color: var(--card-focus-ring);
    box-shadow:
      0 0 0 var(--card-focus-ring-offset) var(--card-bg),
      0 0 0 calc(var(--card-focus-ring-offset) + var(--card-focus-ring-width)) var(--card-focus-ring);
  }

  @media (prefers-reduced-motion: reduce) {
    .resource-card,
    .resource-card:hover {
      transform: none;
    }
  }

  /* Card content area */
  .resource-card__content {
    flex: 1;
    display: flex;
    flex-direction: column;
    padding: var(--card-padding);
  }

  /* Card media/image area */
  .resource-card__media {
    background: var(--card-media-bg);
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  }

  .resource-card__media img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--card-transition);
  }

  .resource-card:hover .resource-card__media img {
    transform: scale(1.05);
  }

  @media (prefers-reduced-motion: reduce) {
    .resource-card:hover .resource-card__media img {
      transform: none;
    }
  }

  /* Card footer - pinned to bottom */
  .resource-card__footer {
    margin-top: auto;
    padding-top: var(--spacing-3);
  }

  /* ========================================
     COVER FRAME - Book cover treatment
     Reduces visual dominance of varied cover images
     ======================================== */

  .cover-frame {
    position: relative;
    background: var(--card-media-bg);
    overflow: hidden;
  }

  /* Subtle vignette overlay to unify contrast */
  .cover-frame::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(
      180deg,
      transparent 0%,
      transparent 70%,
      rgba(0, 0, 0, 0.03) 100%
    );
    pointer-events: none;
  }

  /* Inner border to separate cover from card edge */
  .cover-frame img {
    border: 1px solid rgba(0, 0, 0, 0.05);
  }

  [data-theme="dark"] .cover-frame::after,
  [data-theme="dracula"] .cover-frame::after {
    background: linear-gradient(
      180deg,
      transparent 0%,
      transparent 70%,
      rgba(0, 0, 0, 0.15) 100%
    );
  }

  [data-theme="dark"] .cover-frame img,
  [data-theme="dracula"] .cover-frame img {
    border-color: rgba(255, 255, 255, 0.1);
  }

  /* ========================================
     LOGO TILE - Tool logo wrapper
     Ensures consistent visual weight for varied logos
     ======================================== */

  .logo-tile {
    background: linear-gradient(
      135deg,
      var(--color-neutral-50) 0%,
      var(--color-neutral-100) 100%
    );
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-4);
    border-bottom: 1px solid var(--color-border-default);
  }

  .logo-tile img {
    max-height: 6rem;    /* 96px - larger logos for better visibility */
    max-width: 12rem;    /* 192px */
    width: auto;
    height: auto;
    object-fit: contain;
  }

  [data-theme="dark"] .logo-tile {
    background: linear-gradient(
      135deg,
      var(--color-neutral-800) 0%,
      var(--color-neutral-900) 100%
    );
  }

  [data-theme="dracula"] .logo-tile {
    background: linear-gradient(
      135deg,
      #44475a 0%,
      #282a36 100%
    );
  }

  /* Logo placeholder for tools without logos */
  .logo-placeholder {
    width: 3.5rem;
    height: 3.5rem;
    border-radius: var(--radius-xl);
    background: linear-gradient(
      135deg,
      var(--color-accent-100) 0%,
      var(--color-accent-50) 100%
    );
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-accent-600);
  }

  [data-theme="dark"] .logo-placeholder,
  [data-theme="dracula"] .logo-placeholder {
    background: linear-gradient(
      135deg,
      rgba(6, 182, 212, 0.2) 0%,
      rgba(6, 182, 212, 0.1) 100%
    );
    color: var(--color-accent-400);
  }

  /* ========================================
     ICON CIRCLE UTILITY - Circular Icon Container
     For icons inside circular backgrounds (stats, features, etc.)
     ======================================== */

  .icon-circle {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 2.5rem;        /* 40px - h-10 equivalent */
    height: 2.5rem;       /* 40px - w-10 equivalent */
    background: var(--color-bg-subtle);
    border-radius: var(--radius-full);
    flex-shrink: 0;
  }

  .icon-circle svg {
    width: 1.25rem;       /* 20px - reasonable icon size */
    height: 1.25rem;
    stroke: currentColor;
  }

  /* ========================================
     FIGURE FRAMING & CAPTIONS
     Semantic figure elements for visualizations with consistent styling
     ======================================== */

  .figure-frame {
    border: 1px solid var(--color-border-default);
    padding: var(--spacing-3);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-sm);
    background: var(--color-bg-surface);
    max-width: 50rem; /* 800px cap for large charts */
    margin: 0 auto;
  }

  .figure-frame img {
    display: block;
    max-width: 100%;
    height: auto;
  }

  .figure-caption {
    margin-top: var(--spacing-3);
    font-size: var(--font-size-supporting);
    line-height: var(--leading-normal);
    color: var(--color-text-secondary);
    text-align: center;
  }

  /* Auto-numbering for figures removed - not used in current implementation */

  /* Pill/badge for labels and tags */
  .pill {
    display: inline-flex;
    align-items: center;
    border-radius: var(--radius-pill);
    border: 1px solid var(--color-border-default);
    padding: var(--spacing-1) var(--spacing-3);
    font-size: 0.875rem; /* text-sm */
    color: var(--color-text-secondary);
  }

  /* Context pill modifier - for metadata badges */
  .pill--context {
    background: var(--color-bg-accent-subtle);
    color: var(--color-text-accent);
    border-color: var(--color-border-accent);
    font-size: 0.8125rem; /* 13px - slightly smaller */
    padding: var(--spacing-1) var(--spacing-2);
  }

  /* Code pill modifier - for language badges in code blocks */
  .pill--code {
    background: var(--color-bg-subtle);
    color: var(--color-text-secondary);
    border-color: var(--color-border-subtle);
    font-size: 0.6875rem; /* 11px - compact for metadata */
    font-weight: var(--font-weight-semibold);
    padding: var(--spacing-1) var(--spacing-2);
    letter-spacing: 0.025em; /* Slight tracking for uppercase readability */
  }

  /* Control bar for tab/filter controls */
  .control-bar {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: var(--spacing-2);
  }

  /* ========================================
     LAYOUT SPACING UTILITIES
     ======================================== */

  /* Spacing utilities removed - use Tailwind's built-in utilities instead
     (e.g., py-12, py-6, gap-8, gap-6) */

  /* Button/control base */
  .control {
    padding: var(--spacing-2) var(--spacing-4);
    font-size: 1rem; /* text-base */
    border-radius: var(--radius-lg);
    border: 1px solid var(--color-border-default);
    background-color: var(--color-bg-surface);
    color: var(--color-text-secondary);
    transition: all 0.2s;
  }

  .control:hover {
    background-color: var(--color-bg-subtle);
    border-color: var(--color-neutral-400);
  }

  .control:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px var(--color-accent-500), 0 0 0 4px var(--color-accent-100);
  }

  /* Active/selected control state */
  .control-active {
    background-color: var(--color-bg-surface);
    color: var(--color-text-primary);
    font-weight: 600;
    border-color: var(--color-border-default);
  }

  .control-active:hover {
    background-color: var(--color-bg-surface);
  }

  /* Tab label (peer-checked state needs custom utilities below) */
  .tab-label {
    padding: var(--spacing-2) var(--spacing-4);
    border-radius: var(--radius-lg);
    border: 1px solid var(--color-border-default);
    transition: all 0.2s;
  }

  .tab-label:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px var(--color-accent-500), 0 0 0 4px var(--color-accent-100);
  }

  /* ========================================
     TABLE COMPONENTS - Dark-friendly theme
     Stage4 table styling with overflow handling
     ======================================== */

  /* Table wrapper - provides scrolling container and gradient indicator */
  .table-wrapper {
    position: relative;
    overflow-x: auto;
    padding-bottom: var(--spacing-3);
    /* Scrollbar styling for dark themes */
    scrollbar-width: thin;
    scrollbar-color: var(--color-border-default) var(--color-bg-subtle);
  }

  /* Webkit scrollbar styling */
  .table-wrapper::-webkit-scrollbar {
    height: 8px;
  }

  .table-wrapper::-webkit-scrollbar-track {
    background: var(--color-bg-subtle);
    border-radius: var(--radius-sm);
  }

  .table-wrapper::-webkit-scrollbar-thumb {
    background: var(--color-border-default);
    border-radius: var(--radius-sm);
  }

  .table-wrapper::-webkit-scrollbar-thumb:hover {
    background: var(--color-border-accent);
  }

  /* Gradient scroll indicator - shows when content overflows */
  .table-wrapper::after {
    content: "";
    pointer-events: none;
    position: sticky;
    top: 0;
    right: 0;
    width: 2rem;
    height: 100%;
    background: linear-gradient(to left, var(--color-bg-surface), transparent);
    float: right;
    margin-left: -2rem;
  }

  /* Remove gradient on reduced motion preference */
  @media (prefers-reduced-motion: reduce) {
    .table-wrapper::after {
      display: none;
    }
  }

  /* Base table styling - targets injected gt tables */
  .card table {
    width: 100% !important;
    border-collapse: collapse !important;
    background: var(--color-bg-surface) !important;
    font-size: 0.875rem !important; /* 14px - readable size */
    margin: 0 !important;
  }

  /* Override gt table inline styles for theme support */
  .card table.gt_table {
    background-color: var(--color-bg-surface) !important;
    color: var(--color-text-primary) !important;
    border-top-color: var(--color-border-default) !important;
    border-bottom-color: var(--color-border-default) !important;
  }

  /* Table cells - consistent padding and theme colors */
  .card table td,
  .card table th {
    padding: var(--spacing-3) var(--spacing-4) !important;
    color: var(--color-text-primary) !important;
    border-color: var(--color-border-subtle) !important;
  }

  /* Table headers - sticky with accent background */
  .card table thead th {
    position: sticky;
    top: 0;
    z-index: 10;
    background-color: var(--color-bg-accent-subtle) !important;
    color: var(--color-text-accent) !important;
    font-weight: var(--font-weight-semibold) !important;
    border-bottom: 1px solid var(--color-border-default) !important;
    text-align: left;
  }

  /* Column headings specific styling */
  .card table .gt_col_heading,
  .card table .gt_col_headings th {
    background-color: var(--color-bg-accent-subtle) !important;
    color: var(--color-text-accent) !important;
  }

  /* Table title styling */
  .card table .gt_heading .gt_title {
    color: var(--color-text-primary) !important;
    background-color: var(--color-bg-surface) !important;
  }

  /* Zebra striping for better readability */
  .card table tbody tr:nth-child(even) {
    background-color: var(--color-bg-subtle) !important;
  }

  .card table tbody tr:nth-child(odd) {
    background-color: var(--color-bg-surface) !important;
  }

  /* Override gt striped class */
  .card table .gt_striped {
    background-color: var(--color-bg-subtle) !important;
  }

  /* Table body rows */
  .card table .gt_row {
    background-color: inherit !important;
    color: var(--color-text-primary) !important;
    border-top-color: var(--color-border-subtle) !important;
  }

  /* Table stub (row headers) */
  .card table .gt_stub {
    background-color: inherit !important;
    color: var(--color-text-primary) !important;
    border-right-color: var(--color-border-default) !important;
  }

  /* Footer styling - subdued for diagnostics/notes */
  .card table tfoot {
    font-size: 0.8125rem; /* 13px - slightly smaller */
    color: var(--color-text-secondary) !important;
  }

  .card table tfoot td,
  .card table .gt_footnote,
  .card table .gt_sourcenote {
    color: var(--color-text-secondary) !important;
    background-color: var(--color-bg-surface) !important;
    border-color: var(--color-border-subtle) !important;
  }

  /* Condensed density modifier - for regression outputs with many rows */
  .card[data-density="condensed"] table td,
  .card[data-density="condensed"] table th {
    padding: var(--spacing-2) var(--spacing-3) !important;
  }

  /* Group headings within tables */
  .card table .gt_group_heading {
    background-color: var(--color-bg-accent-subtle) !important;
    color: var(--color-text-accent) !important;
    font-weight: var(--font-weight-medium) !important;
    border-color: var(--color-border-default) !important;
  }

  /* Summary rows styling */
  .card table .gt_summary_row,
  .card table .gt_grand_summary_row {
    background-color: var(--color-bg-subtle) !important;
    color: var(--color-text-primary) !important;
    font-weight: var(--font-weight-medium) !important;
  }

  /* Legacy table utilities removed - not used in current implementation */

  /* Code block styling with semantic tokens */
  pre {
    background-color: var(--color-code-bg);
    color: var(--color-code-text);
    border-left: 2px solid var(--color-code-border);
    padding: var(--spacing-4);
    border-radius: var(--radius-md);
    overflow-x: auto;
  }

  code {
    font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Monaco, 'Courier New', monospace;
    font-size: 0.9em;
    color: var(--color-code-text);
  }

  /* Inline code (not in pre) gets subtle background */
  :not(pre) > code {
    background-color: var(--color-bg-accent-subtle);
    color: var(--color-text-primary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
  }

  /* ========================================
     ICON & BADGE COMPONENTS
     ======================================== */

  /* NOTE: .icon-circle is defined earlier in the components layer (line ~632)
     This duplicate section has been removed to eliminate conflicting definitions */

  /* ========================================
     SEMANTIC TEXT UTILITIES
     ======================================== */

  .text-primary {
    color: var(--color-text-primary);
  }

  .text-secondary {
    color: var(--color-text-secondary);
  }

  .text-tertiary {
    color: var(--color-text-tertiary);
  }

  .text-muted {
    color: var(--color-text-muted);
  }

  .text-accent {
    color: var(--color-text-accent);
  }

  /* ========================================
     SEMANTIC BACKGROUND UTILITIES
     ======================================== */

  .bg-surface {
    background-color: var(--color-bg-surface);
  }

  .bg-subtle {
    background-color: var(--color-bg-subtle);
  }

  .bg-accent {
    background-color: var(--color-bg-accent);
  }

  .bg-accent-subtle {
    background-color: var(--color-bg-accent-subtle);
  }

  /* ========================================
     SEMANTIC BORDER UTILITIES
     ======================================== */

  .border-default {
    border-color: var(--color-border-default);
  }

  .border-subtle {
    border-color: var(--color-border-subtle);
  }

  .border-accent {
    border-color: var(--color-border-accent);
  }

  /* ========================================
     HERO GRADIENT
     ======================================== */

  /* .hero-gradient removed - landing page uses fixed Tailwind gradient */

  /* ========================================
     TYPOGRAPHY CLASSES
     Semantic classes for consistent text hierarchy
     Use these instead of raw text-* utilities
     ======================================== */

  /* Post title - Main heading for each post */
.post-title {
  font-size: var(--font-size-post-title);
  font-weight: var(--font-weight-semibold);
  line-height: var(--leading-tight);
  color: var(--color-text-primary);
  position: relative;
  display: inline-block;
  max-width: 100%;
  background: linear-gradient(90deg, var(--color-text-primary), var(--color-text-accent));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  text-shadow: 0 4px 16px rgba(0, 0, 0, 0.25);
  text-wrap: balance;
}

  /* Section title - Primary H1 headings (Overview, Data Access, etc.) */
  .section-title {
    font-size: var(--font-size-section-title);
    font-weight: var(--font-weight-semibold);
    line-height: var(--leading-tight);
    color: var(--color-text-accent);
    scroll-margin-top: 6rem; /* Offset for sticky header when using anchor links */
  }

  /* Panel title - Secondary H2/H3 headings within sections */
  .panel-title {
    font-size: var(--font-size-panel-title);
    font-weight: var(--font-weight-medium);
    line-height: var(--leading-normal);
    color: var(--color-text-accent);
  }

  /* Body text - Regular paragraph content */
  .body-text {
    font-size: var(--font-size-body);
    font-weight: var(--font-weight-regular);
    line-height: var(--leading-longform);
    color: var(--color-text-primary);
  }

  /* Supporting text - Metadata, descriptions, secondary content */
  .supporting-text {
    font-size: var(--font-size-supporting);
    font-weight: var(--font-weight-regular);
    line-height: var(--leading-normal);
    color: var(--color-text-secondary);
  }

  /* Stat label - Labels in statistics panels */
  .stat-label {
    font-size: var(--font-size-supporting);
    font-weight: var(--font-weight-medium);
    line-height: var(--leading-normal);
    color: var(--color-text-secondary);
  }

  /* Stat value - Descriptive text values in statistics */
  .stat-value {
    font-size: var(--font-size-stat-value);
    font-weight: var(--font-weight-regular);
    line-height: var(--leading-normal);
    color: var(--color-text-primary);
  }

  /* ========================================
     INTERACTIVE STATE UTILITIES
     Reusable hover/focus patterns for consistent UX
     ======================================== */

  /* Focus ring - WCAG 2.1 AA compliant outline for all interactive elements */
  .focus-ring:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px var(--color-accent-500), 0 0 0 4px var(--color-accent-100);
    border-radius: var(--radius-md);
  }

  /* Hover elevate effect removed - use .card-hover instead */

  /* ========================================
     ASIDE/TABLE OF CONTENTS COMPONENTS
     Dark theme with teal accents
     ======================================== */

  /* Main aside container - dark with transparency and blur */
  .aside-container {
    background-color: var(--color-aside-bg);
    backdrop-filter: blur(12px);
    border-radius: var(--radius-lg);
    border: 1px solid var(--color-aside-border);
    box-shadow: var(--shadow-md);
    overflow: hidden;
  }

  /* Aside section heading (e.g., "On this page", "Contribute") */
  .aside-heading {
    padding: var(--spacing-3) var(--spacing-3) var(--spacing-1);
    font-size: 0.75rem; /* text-xs */
    font-weight: var(--font-weight-semibold);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-aside-text-muted);
  }

  /* Aside navigation link */
  .aside-link {
    display: block;
    padding: var(--spacing-1) var(--spacing-1);
    font-size: 0.75rem; /* text-xs */
    line-height: 1.25;
    color: var(--color-aside-text-primary);
    border-radius: var(--radius-md);
    border-left: 2px solid transparent;
    transition: all 0.2s;
    cursor: pointer;
  }

  .aside-link:hover {
    color: var(--color-aside-hover-text);
    background-color: var(--color-aside-hover-bg);
    border-left-color: var(--color-aside-hover-border);
  }

  .aside-link:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px var(--color-accent-400), 0 0 0 4px rgba(6, 182, 212, 0.2);
  }

  /* Aside action link (Edit/Discussion with icons) */
  .aside-action {
    display: flex;
    align-items: center;
    gap: var(--spacing-2);
    padding: var(--spacing-1) var(--spacing-2);
    border-radius: var(--radius-md);
    font-size: 0.75rem; /* text-xs */
    color: var(--color-aside-text-primary);
    transition: all 0.2s;
  }

  .aside-action:hover {
    color: var(--color-aside-hover-text);
    background-color: var(--color-aside-hover-bg);
  }

  /* Icon within aside action */
  .aside-action-icon {
    width: 1rem;
    height: 1rem;
    color: var(--color-accent-400);
    opacity: 0.9;
    transition: color 0.2s;
  }

  .aside-action:hover .aside-action-icon {
    color: var(--color-accent-300);
  }

  /* External link indicator */
  .aside-external-indicator {
    margin-left: auto;
    color: var(--color-aside-text-muted);
    opacity: 0.6;
    transition: opacity 0.2s;
  }

  .aside-action:hover .aside-external-indicator {
    opacity: 1;
    color: var(--color-aside-text-secondary);
  }

  .aside-action[disabled],
  .aside-action--disabled {
    opacity: 0.6;
    cursor: not-allowed;
    background: transparent;
    color: var(--color-aside-text-muted);
    pointer-events: none;
  }

  .aside-action[disabled] .aside-action-icon,
  .aside-action--disabled .aside-action-icon {
    color: var(--color-aside-text-muted);
  }

  /* Aside divider - dashed border between sections */
  .aside-divider {
    margin: var(--spacing-3) var(--spacing-3);
    border-top: 1px dashed var(--color-aside-border-accent);
  }


  .right-aside-panel {
    height: 100%;
    transition: transform 0.3s ease;
  }

  .right-aside-panel--collapsed {
    transform: translateX(100%);
  }

  .right-aside-panel--collapsed .aside-container {
    opacity: 0;
    pointer-events: none;
  }

  .right-aside-toggle {
    position: absolute;
    top: 1rem;
    right: 0.75rem;
    width: 2.25rem;
    height: 2.25rem;
    border-radius: var(--radius-full);
    border: 1px solid var(--color-border-default);
    background: var(--color-bg-surface);
    color: var(--color-text-primary);
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: var(--shadow-sm);
    transition: background-color 0.2s ease, transform 0.3s ease;
  }

  .right-aside-toggle:hover {
    background: var(--color-bg-subtle);
  }

  .right-aside-toggle__icon {
    width: 1rem;
    height: 1rem;
    transition: transform 0.3s ease;
  }

  .right-aside-toggle--collapsed .right-aside-toggle__icon {
    transform: rotate(180deg);
  }

  /* Download button - contrasts with aside background */
  .download-btn {
    padding: var(--spacing-2) var(--spacing-3);
    background-color: var(--color-bg-surface);
    border: 1px solid var(--color-border-default);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-sm);
    transition: all 0.2s;
    color: var(--color-text-primary);
  }

  .download-btn:hover {
    background-color: var(--color-bg-subtle);
    border-color: var(--color-accent-400);
    box-shadow: 0 4px 12px rgba(6, 182, 212, 0.15);
    transform: translateY(-1px);
  }

  .download-btn:active {
    transform: translateY(0);
    box-shadow: var(--shadow-xs);
  }

  /* Respect reduced-motion preference */
  @media (prefers-reduced-motion: reduce) {
    .download-btn:hover,
    .download-btn:active {
      transform: none;
    }
  }

  /* Download button icon */
  .download-btn-icon {
    width: 1rem;
    height: 1rem;
  }


  /* ========================================
     BUTTON COMPONENTS - Secondary Style
     Reusable button styling for interactive controls
     ======================================== */

  .btn-secondary {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-2) var(--spacing-4);
    background-color: var(--color-bg-surface);
    border: 1px solid var(--color-border-default);
    border-radius: var(--radius-md);
    font-size: 0.875rem; /* 14px */
    color: var(--color-text-primary);
    cursor: pointer;
    transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease;
    user-select: none;
  }

  .btn-secondary:hover {
    background-color: var(--color-bg-subtle);
    border-color: var(--color-border-accent);
    color: var(--color-text-accent);
  }

  .btn-secondary:focus-visible {
    outline: 2px solid var(--color-focus-ring);
    outline-offset: 2px;
  }

  /* ========================================
     COPY CODE BUTTON
     Appears on code blocks for clipboard copying
     Enhanced contrast for better visibility in dark themes
     ======================================== */

  .copy-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem; /* 6px - space between icon and text */
    padding: 0 var(--spacing-3);
    min-height: 2.25rem; /* 36px - meets 44px tap target with surrounding spacing */
    background-color: var(--color-bg-accent-subtle);
    border: 1px solid var(--color-border-accent);
    border-radius: var(--radius-md);
    font-size: 0.75rem; /* text-xs */
    color: var(--color-text-accent);
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
    cursor: pointer;
    user-select: none;
  }

  .copy-btn:hover {
    background-color: var(--color-bg-accent);
    border-color: var(--color-border-accent);
    color: var(--color-neutral-900);
  }

  .copy-btn:focus-visible {
    outline: 2px solid var(--color-focus-ring);
    outline-offset: 2px;
  }

  .copy-btn:active {
    transform: translateY(1px);
  }

  /* Respect reduced-motion preference */
  @media (prefers-reduced-motion: reduce) {
    .copy-btn:active {
      transform: none;
    }
  }

  /* ========================================
     GUIDE TOC (Inline Navigation)
     Horizontal section navigation bar
     ======================================== */

  .guide-toc {
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE/Edge */
  }

  .guide-toc::-webkit-scrollbar {
    display: none; /* Chrome/Safari */
  }

  .guide-toc-link {
    transition: color 0.15s ease, background-color 0.15s ease;
  }

  .guide-toc-link.active {
    color: var(--color-text-accent);
    background-color: rgba(6, 182, 212, 0.1);
  }

  /* Hide scrollbar utility */
  .scrollbar-hide {
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* ========================================
     GUIDE 3-COLUMN LAYOUT
     Sidebar navigation + main content + right rail
     ======================================== */

  /* Container for header and footer - aligns with content column */
  .guide-header-container {
    max-width: 75ch;
    margin-left: auto;
    margin-right: auto;
    padding: 2rem 1.5rem;
  }

  /* On larger screens, offset to account for sidebar */
  @media (min-width: 1280px) {
    .guide-header-container {
      max-width: calc(75ch + 16rem);
      padding-left: calc(16rem + 3rem);
    }
  }

  /* ----------------------------------------
     Guide Navigation Tabs
     Horizontal tabs for hub/tutorial/reference navigation
     ---------------------------------------- */

  .guide-nav-tabs {
    border-bottom: 1px solid var(--color-border-default);
    background-color: var(--color-bg-subtle);
  }

  .guide-nav-tabs-container {
    display: flex;
    gap: var(--spacing-1);
    max-width: 75ch;
    margin: 0 auto;
    padding: 0 1.5rem;
  }

  /* On larger screens, offset to account for sidebar (matches header) */
  @media (min-width: 1280px) {
    .guide-nav-tabs-container {
      max-width: calc(75ch + 16rem);
      padding-left: calc(16rem + 3rem);
    }
  }

  .guide-nav-tab {
    position: relative;
    padding: var(--spacing-3) var(--spacing-4);
    font-size: 0.875rem;
    font-weight: var(--font-weight-medium);
    color: var(--color-text-secondary);
    text-decoration: none;
    border-bottom: 2px solid transparent;
    margin-bottom: -1px; /* Overlap container border */
    transition: color 0.15s ease, border-color 0.15s ease;
  }

  .guide-nav-tab:hover {
    color: var(--color-text-primary);
  }

  .guide-nav-tab--active {
    color: var(--color-text-accent);
    border-bottom-color: var(--color-accent-500);
  }

  .guide-nav-tab--active:hover {
    color: var(--color-text-accent);
  }

  /* Disabled state for non-existent pages (future use) */
  .guide-nav-tab--disabled {
    color: var(--color-text-muted);
    opacity: 0.5;
    pointer-events: none;
  }

  /* 3-column grid container */
  .guide-layout-container {
    display: grid;
    grid-template-columns: 1fr;
    max-width: 100%;
    margin: 0 auto;
  }

  /* Desktop: show sidebar */
  @media (min-width: 1280px) {
    .guide-layout-container {
      grid-template-columns: 16rem 1fr 4rem;
      max-width: 90rem;
      gap: 2rem;
    }
  }

  /* Left sidebar column */
  .guide-sidebar {
    display: none;
  }

  @media (min-width: 1280px) {
    .guide-sidebar {
      display: block;
      padding: 2rem 0 2rem 1.5rem;
    }
  }

  /* Sticky positioning for sidebar content */
  .guide-sidebar-sticky {
    position: sticky;
    top: 2rem;
    max-height: calc(100vh - 4rem);
    overflow-y: auto;
    scrollbar-width: thin;
  }

  /* Main content column */
  .guide-main {
    padding: 2rem 1.5rem;
    min-width: 0; /* Allow content to shrink below min-content */
  }

  @media (min-width: 1280px) {
    .guide-main {
      padding: 2rem 0;
    }
  }

  /* Right rail (empty for now) */
  .guide-right-rail {
    display: none;
  }

  @media (min-width: 1280px) {
    .guide-right-rail {
      display: block;
    }
  }

  /* ========================================
     GUIDE SIDEBAR NAVIGATION
     Hierarchical outline for intra-guide nav
     ======================================== */

  .guide-sidebar-nav {
    font-size: 0.875rem;
    line-height: 1.5;
    /* Subtle background to differentiate from main content */
    background: var(--color-bg-subtle);
    padding: 1rem;
    border-radius: var(--radius-lg);
    border: 1px solid var(--color-border-subtle);
  }

  /* Dark mode: slightly lighter than page background */
  [data-theme="dark"] .guide-sidebar-nav,
  [data-theme="dracula"] .guide-sidebar-nav {
    background: rgba(51, 65, 85, 0.3); /* slate-700 at 30% */
    border-color: rgba(71, 85, 105, 0.3);
  }

  .guide-sidebar-header {
    padding-bottom: 0.75rem;
    margin-bottom: 0.75rem;
    border-bottom: 1px solid var(--color-border-subtle);
  }

  .guide-sidebar-title {
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
  }

  .guide-sidebar-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  /* Base item styling */
  .guide-sidebar-item {
    margin: 0;
    padding: 0;
  }

  /* ----------------------------------------
     LEVEL 2 (H2) - Major Section Headers
     Uppercase labels with visual separation
     ---------------------------------------- */
  .guide-sidebar-item.level-2 {
    margin-top: 1.25rem;
    padding-top: 1rem;
    border-top: 1px solid var(--color-border-subtle);
  }

  .guide-sidebar-item.level-2:first-child {
    margin-top: 0;
    padding-top: 0;
    border-top: none;
  }

  /* H2 links styled as section group labels */
  .guide-sidebar-item.level-2 > .guide-sidebar-link {
    font-size: 0.6875rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
    padding: 0.25rem 0;
    margin-left: 0;
    border-radius: 0;
  }

  .guide-sidebar-item.level-2 > .guide-sidebar-link:hover {
    color: var(--color-text-accent);
    background-color: transparent;
  }

  /* ----------------------------------------
     LEVEL 3 (H3) - Primary Navigation Items
     Main clickable items within sections
     ---------------------------------------- */
  .guide-sidebar-item.level-3 {
    position: relative;
    margin-left: 0.5rem;
    padding-left: 0.75rem;
    /* Slightly de-emphasized inactive rail (85% opacity) */
    border-left: 2px solid color-mix(in srgb, var(--color-border-subtle) 85%, transparent);
  }

  .guide-sidebar-item.level-3 > .guide-sidebar-link {
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--color-text-primary);
    padding: 0.375rem 0.5rem;
    margin-left: -0.5rem;
    border-radius: 0.25rem;
  }

  .guide-sidebar-item.level-3 > .guide-sidebar-link:hover {
    color: var(--color-text-accent);
    background-color: rgba(6, 182, 212, 0.08);
  }

  /* ----------------------------------------
     LEVEL 4 (H4) - Secondary Navigation Items
     Nested items under H3s
     ---------------------------------------- */
  .guide-sidebar-item.level-4 {
    position: relative;
    margin-left: 0.5rem;
    padding-left: 0.75rem;
    /* Slightly de-emphasized inactive rail (85% opacity) */
    border-left: 2px solid color-mix(in srgb, var(--color-border-subtle) 85%, transparent);
  }

  .guide-sidebar-item.level-4 > .guide-sidebar-link {
    font-size: 0.8125rem;
    font-weight: 400;
    color: var(--color-text-secondary);
    padding: 0.25rem 0.5rem;
    margin-left: -0.5rem;
    border-radius: 0.25rem;
  }

  .guide-sidebar-item.level-4 > .guide-sidebar-link:hover {
    color: var(--color-text-accent);
    background-color: rgba(6, 182, 212, 0.08);
  }

  /* ----------------------------------------
     General Link Styling
     ---------------------------------------- */
  .guide-sidebar-link {
    display: block;
    text-decoration: none;
    transition: color 0.15s ease, background-color 0.15s ease;
  }

  /* Children list container */
  .guide-sidebar-children {
    list-style: none;
    padding: 0;
    margin: 0.375rem 0 0.25rem 0;
  }

  /* Remove border-left from first child to avoid double line at top */
  .guide-sidebar-children > .guide-sidebar-item:first-child {
    /* Maintains visual continuity */
  }

  /* ----------------------------------------
     Active State (Scrollspy)
     ---------------------------------------- */
  .guide-sidebar-link.active {
    color: var(--color-text-accent);
    font-weight: 500;
  }

  /* Active indicator for level-3/4 items - accent border */
  .guide-sidebar-item.level-3:has(> .guide-sidebar-link.active),
  .guide-sidebar-item.level-4:has(> .guide-sidebar-link.active) {
    border-left-color: var(--color-accent-500);
  }

  .guide-sidebar-item.level-3 > .guide-sidebar-link.active,
  .guide-sidebar-item.level-4 > .guide-sidebar-link.active {
    background-color: rgba(6, 182, 212, 0.1);
  }

  /* ========================================
     GUIDE CONTENT TYPOGRAPHY
     v1.2: Calmer pacing, guided rhythm
     - Strong visual pauses at H2/H3
     - Generous spacing before code blocks
     - Readable, skimmable prose
     ======================================== */

  /* Content width for optimal readability */
  .guide-content {
    max-width: 75ch;
  }

  /* Consistent vertical rhythm between all block elements */
  .guide-content > * + * {
    margin-top: 1.5rem;
  }

  /* Main H2 sections - visually dominant chapter markers */
  .guide-content > h2 {
    font-size: 1.875rem;  /* ~30px - larger for clear hierarchy */
    font-weight: 600;
    letter-spacing: -0.02em;
    color: var(--color-text-primary);
    margin-top: 5rem;  /* Very strong top separation - creates visual "pause" */
    margin-bottom: 1.75rem;
    padding-bottom: 0.875rem;
    border-bottom: 1px solid var(--color-border-subtle);
    scroll-margin-top: 6rem;
  }

  /* First H2 doesn't need excessive top margin */
  .guide-content > h2:first-of-type {
    margin-top: 0;
  }

  /* Subsection H3s - clear but subordinate to H2 */
  .guide-content h3 {
    font-size: 1.375rem;  /* ~22px */
    font-weight: 600;
    letter-spacing: -0.01em;
    color: var(--color-text-primary);
    margin-top: 3.5rem;  /* Increased from 2.5rem - more breathing room */
    margin-bottom: 1.25rem;
    scroll-margin-top: 6rem;
  }

  /* H3 after H2 needs less space (already have H2 margin-bottom) */
  .guide-content h2 + h3 {
    margin-top: 2rem;
  }

  /* H4s - subtle tertiary level */
  .guide-content h4 {
    font-size: 1.125rem;  /* 18px */
    font-weight: 600;
    color: var(--color-text-secondary);
    margin-top: 2.5rem;
    margin-bottom: 1rem;
    scroll-margin-top: 6rem;
  }

  /* H4 after H3 needs less space */
  .guide-content h3 + h4 {
    margin-top: 1.5rem;
  }

  /* H5s - for inline labeled sections */
  .guide-content h5 {
    font-size: 1rem;
    font-weight: 600;
    color: var(--color-text-secondary);
    margin-top: 2rem;
    margin-bottom: 0.75rem;
    scroll-margin-top: 6rem;
  }

  /* Paragraphs within guide - generous line height for conceptual text */
  .guide-content p {
    margin-bottom: 1.375rem;
    line-height: 1.8;  /* Increased from 1.75 - more readable for long text */
  }

  /* Lists - explicit markers for clarity */
  .guide-content ul {
    list-style-type: disc;
    margin-bottom: 1.5rem;
    padding-left: 1.75rem;
  }

  .guide-content ol {
    list-style-type: decimal;
    margin-bottom: 1.5rem;
    padding-left: 1.75rem;
  }

  .guide-content li {
    margin-bottom: 0.75rem;
    line-height: 1.75;
    padding-left: 0.25rem;
  }

  /* List marker styling - uses accent color for visual interest */
  .guide-content ul > li::marker {
    color: var(--color-accent-500);
  }

  .guide-content ol > li::marker {
    color: var(--color-text-secondary);
    font-weight: 500;
  }

  /* Nested lists */
  .guide-content li > ul {
    list-style-type: circle;
    margin-top: 0.625rem;
    margin-bottom: 0.625rem;
  }

  .guide-content li > ol {
    list-style-type: lower-alpha;
    margin-top: 0.625rem;
    margin-bottom: 0.625rem;
  }

  /* Second level nesting */
  .guide-content li > ul > li > ul {
    list-style-type: square;
  }

  /* Horizontal rules - subtle dividers for section rhythm */
  .guide-content hr {
    border: none;
    height: 1px;
    background: var(--color-border-subtle);
    margin: 2.5rem 0;
    opacity: 0.6;
  }

  /* Faded bookend variant - softer edges for conceptual transitions */
  .guide-content hr.faded,
  .guide-content h2 + hr,
  .guide-content h3 + hr {
    background: linear-gradient(
      90deg,
      transparent 0%,
      var(--color-border-subtle) 15%,
      var(--color-border-subtle) 85%,
      transparent 100%
    );
    opacity: 0.5;
    max-width: 80%;
    margin-left: auto;
    margin-right: auto;
  }

  /* Stronger rule after major sections (before h2) */
  .guide-content hr + h2 {
    margin-top: 3rem;
  }

  /* Strong text emphasis */
  .guide-content strong {
    font-weight: 600;
    color: var(--color-text-primary);
  }

  /* Secondary/muted text - clearly subordinate */
  .guide-content em {
    font-style: italic;
    color: var(--color-text-secondary);
  }

  /* Prose → Code transition spacing */
  .guide-content p + .code-block-wrapper,
  .guide-content ul + .code-block-wrapper,
  .guide-content ol + .code-block-wrapper {
    margin-top: 2rem;
  }

  /* Code → Prose transition spacing (slightly less) */
  .guide-content .code-block-wrapper + p,
  .guide-content .code-block-wrapper + ul,
  .guide-content .code-block-wrapper + ol {
    margin-top: 1.5rem;
  }

  /* Heading after code block needs extra space */
  .guide-content .code-block-wrapper + h3,
  .guide-content .code-block-wrapper + h4 {
    margin-top: 3rem;
  }

  /* ========================================
     PROSE OVERRIDES
     Harmonize @tailwindcss/typography with our design tokens.
     Our .guide-content rules take precedence for most typography,
     but prose provides good defaults for elements we don't explicitly style.
     ======================================== */

  /* Ensure prose uses our color tokens */
  .guide-content.prose {
    --tw-prose-body: var(--color-text-secondary);
    --tw-prose-headings: var(--color-text-primary);
    --tw-prose-links: var(--color-accent-500);
    --tw-prose-bold: var(--color-text-primary);
    --tw-prose-counters: var(--color-text-secondary);
    --tw-prose-bullets: var(--color-accent-500);
    --tw-prose-hr: var(--color-border-subtle);
    --tw-prose-quotes: var(--color-text-secondary);
    --tw-prose-quote-borders: var(--color-accent-500);
    --tw-prose-captions: var(--color-text-muted);
    --tw-prose-code: var(--color-accent-500);
    --tw-prose-pre-code: var(--color-neutral-100);
    --tw-prose-pre-bg: var(--color-code-bg);
    --tw-prose-th-borders: var(--color-border-default);
    --tw-prose-td-borders: var(--color-border-subtle);
  }

  /* Dark mode prose overrides */
  [data-theme="dark"] .guide-content.prose,
  [data-theme="dracula"] .guide-content.prose {
    --tw-prose-body: var(--color-text-secondary);
    --tw-prose-headings: var(--color-text-primary);
    --tw-prose-links: var(--color-accent-400);
    --tw-prose-bold: var(--color-text-primary);
    --tw-prose-counters: var(--color-text-secondary);
    --tw-prose-bullets: var(--color-accent-400);
    --tw-prose-hr: var(--color-border-subtle);
    --tw-prose-quotes: var(--color-text-secondary);
    --tw-prose-quote-borders: var(--color-accent-400);
    --tw-prose-captions: var(--color-text-muted);
    --tw-prose-code: var(--color-accent-400);
    --tw-prose-pre-code: var(--color-neutral-100);
    --tw-prose-pre-bg: var(--color-code-bg);
    --tw-prose-th-borders: var(--color-border-default);
    --tw-prose-td-borders: var(--color-border-subtle);
  }

  /* Blockquotes - styled as emphasis panels */
  .guide-content blockquote {
    border-left: 4px solid var(--color-accent-500);
    background: var(--color-bg-accent-subtle);
    padding: 1rem 1.5rem;
    margin: 1.5rem 0;
    border-radius: 0 var(--radius-md) var(--radius-md) 0;
    font-style: italic;
    color: var(--color-text-secondary);
  }

  .guide-content blockquote p {
    margin-bottom: 0;
  }

  [data-theme="dark"] .guide-content blockquote,
  [data-theme="dracula"] .guide-content blockquote {
    border-left-color: var(--color-accent-400);
    background: rgba(6, 182, 212, 0.1);
  }

  /* ========================================
     GUIDE CODE BLOCK STYLES
     v1.2: Recessed terminal aesthetic
     - Darkest surface on the page
     - Subtle inset framing
     - Calm, professional appearance
     ======================================== */

  /* Wrapper for code blocks - creates the outer container */
  .code-block-wrapper {
    position: relative;
    margin: 2rem 0 1.5rem 0;  /* More space before, slightly less after */
    border-radius: var(--radius-lg);
    overflow: hidden;
    /* Inset framing effect */
    box-shadow:
      inset 0 1px 3px rgba(0, 0, 0, 0.2),
      0 1px 0 rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(0, 0, 0, 0.3);
  }

  /* Code header bar - language label and copy button */
  .code-block-wrapper::before {
    content: attr(data-language);
    display: block;
    padding: 0.625rem 1rem;  /* Sized to fit copy button */
    /* Gradient that fades into code background for seamless look */
    background: linear-gradient(
      180deg,
      rgba(30, 41, 59, 0.7) 0%,
      rgba(13, 17, 23, 1) 100%  /* Matches code bg #0d1117 */
    );
    /* No border - seamless transition to code area */
    border: none;
    font-family: var(--font-mono);
    font-size: 0.75rem;  /* 12px - more readable */
    font-weight: 600;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    color: var(--color-accent-400);
  }

  /* Minimal header for blocks without language - still show bar for copy button context */
  .code-block-wrapper[data-language=""]::before,
  .code-block-wrapper:not([data-language])::before {
    /* Match height of language headers for button alignment */
    padding: 0.625rem 1rem;
    min-height: 1rem;  /* Ensure consistent height even with no content */
  }

  /* Position copy button in the header area */
  .code-block-wrapper .guide-copy-btn {
    position: absolute;
    top: 0.375rem;  /* Positioned to center in header */
    right: 1rem;
    z-index: 10;
    padding: 0.25rem 0.625rem;
    font-size: 0.6875rem;  /* 11px */
    font-weight: 500;
    background: rgba(6, 182, 212, 0.15);
    border: 1px solid rgba(6, 182, 212, 0.3);
    border-radius: var(--radius-sm);
    color: var(--color-accent-400);
    opacity: 0.7;
    transition: all 0.15s ease;
  }

  .code-block-wrapper:hover .guide-copy-btn {
    opacity: 1;
    background: rgba(6, 182, 212, 0.25);
  }

  .code-block-wrapper .guide-copy-btn:hover {
    background: rgba(6, 182, 212, 0.35);
    border-color: var(--color-accent-400);
  }

  /* Code block body - darkest surface */
  .code-block-wrapper pre {
    margin: 0;
    padding: 1rem 1.25rem;
    /* Darkest surface - true recessed terminal look */
    background-color: #0d1117;  /* GitHub dark bg */
    /* Force no border - override any inherited styles */
    border: none !important;
    border-radius: 0 !important;
    outline: none !important;
    overflow-x: auto;
    font-size: 0.8125rem;  /* 13px */
    line-height: 1.65;
    /* Remove inner shadow for cleaner look */
    box-shadow: none;
  }

  /* Light mode adjustment */
  :root:not(.dark) .code-block-wrapper pre {
    background-color: #1e1e1e;  /* VS Code dark */
  }

  /* ========================================
     SYNTAX HIGHLIGHTING COLORS (GLOBAL)
     Vibrant, engaging palette inspired by
     Dracula/One Dark with teal accents

     These classes apply globally so syntax
     highlighting works in guides, tutorials,
     and any other code context.
     ======================================== */

  /* Comments - muted but readable */
  .syn-comment {
    color: #6272a4;
    font-style: italic;
  }

  /* Strings - vibrant green */
  .syn-string {
    color: #50fa7b;
  }

  /* Numbers - warm orange */
  .syn-number {
    color: #ffb86c;
  }

  /* Keywords - vibrant pink/magenta */
  .syn-keyword {
    color: #ff79c6;
    font-weight: 500;
  }

  /* Functions - cyan/teal (matches site accent) */
  .syn-function {
    color: #8be9fd;
  }

  /* Types - purple */
  .syn-type {
    color: #bd93f9;
  }

  /* Variables - light foreground */
  .syn-variable {
    color: #f8f8f2;
  }

  /* Operators & punctuation - slightly muted */
  .syn-operator,
  .syn-punctuation {
    color: #ff79c6;
  }

  .code-block-wrapper pre code {
    font-family: var(--font-mono);
    background: transparent;
    padding: 0;
    color: #e6edf3;  /* Light text on dark bg */
  }

  /* Ensure code text is always light on dark background */
  :root:not(.dark) .code-block-wrapper pre code {
    color: #d4d4d4;
  }

  /* ========================================
     TUTORIAL MODULE (COLLAPSIBLE SECTIONS)
     Styling for collapsible H2 sections in guides
     ======================================== */

  .tutorial-module {
    margin: var(--spacing-6) 0;
    border: 1px solid var(--color-border-default);
    border-radius: var(--radius-lg);
    overflow: hidden;
  }

  .tutorial-module summary {
    display: flex;
    align-items: center;
    padding: var(--spacing-4) var(--spacing-5);
    background-color: var(--color-bg-subtle);
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
    cursor: pointer;
    user-select: none;
    list-style: none; /* Remove default marker */
    transition: background-color 0.2s ease;
  }

  .tutorial-module summary::-webkit-details-marker {
    display: none;
  }

  .tutorial-module summary::before {
    content: '';
    display: inline-block;
    width: 0.5rem;
    height: 0.5rem;
    margin-right: var(--spacing-3);
    border-right: 2px solid currentColor;
    border-bottom: 2px solid currentColor;
    transform: rotate(-45deg);
    transition: transform 0.2s ease;
  }

  .tutorial-module[open] summary::before {
    transform: rotate(45deg);
  }

  .tutorial-module summary:hover {
    background-color: var(--color-bg-elevated);
  }

  .tutorial-module summary:focus-visible {
    outline: 2px solid var(--color-focus-ring);
    outline-offset: -2px;
  }

  .tutorial-module .module-content {
    padding: var(--spacing-5);
    border-top: 1px solid var(--color-border-default);
  }

  /* ========================================
     CALLOUT STYLES
     v1.1 Polish: Full background, rounded corners
     Match gold standard design
     ======================================== */

  .callout {
    margin: 1.75rem 0;
    padding: 1.5rem 1.75rem;
    border-radius: 0.75rem;  /* Smoother corners */
    border: 1px solid;
    border-left-width: 4px;
  }

  .callout-title {
    display: flex;
    align-items: center;
    gap: var(--spacing-2);
    font-weight: 700;
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 0.75rem;
  }

  .callout-body {
    font-size: 1rem;
    line-height: 1.7;
    font-style: italic;  /* Match gold standard italic content */
  }

  .callout-body > :first-child {
    margin-top: 0;
  }

  .callout-body > :last-child {
    margin-bottom: 0;
  }

  .callout-content > :first-child {
    margin-top: 0;
  }

  .callout-content > :last-child {
    margin-bottom: 0;
  }

  /* Tip callout - emerald/green */
  .callout-tip {
    background-color: rgba(16, 185, 129, 0.15);
    border-color: rgba(16, 185, 129, 0.3);
    border-left-color: var(--color-emerald-500);
  }

  .callout-tip .callout-title {
    color: var(--color-emerald-400);
  }

  /* Warning callout - amber */
  .callout-warning {
    background-color: rgba(245, 158, 11, 0.12);
    border-color: rgba(245, 158, 11, 0.25);
    border-left-color: var(--color-amber-500);
  }

  .callout-warning .callout-title {
    color: var(--color-amber-400);
  }

  /* Note callout - blue (primary callout type) */
  .callout-note {
    background-color: rgba(59, 130, 246, 0.12);
    border-color: rgba(59, 130, 246, 0.25);
    border-left-color: var(--color-blue-500);
  }

  .callout-note .callout-title {
    color: var(--color-blue-400);
  }

  /* Pitfall callout - red */
  .callout-pitfall {
    background-color: rgba(239, 68, 68, 0.12);
    border-color: rgba(239, 68, 68, 0.25);
    border-left-color: var(--color-red-500);
  }

  .callout-pitfall .callout-title {
    color: var(--color-red-400);
  }

  /* Info callout - purple */
  .callout-info {
    background-color: rgba(139, 92, 246, 0.12);
    border-color: rgba(139, 92, 246, 0.25);
    border-left-color: var(--color-violet-500);
  }

  .callout-info .callout-title {
    color: var(--color-violet-400);
  }

  /* Didactic callout - cyan */
  .callout-didactic {
    background-color: rgba(6, 182, 212, 0.12);
    border-color: rgba(6, 182, 212, 0.25);
    border-left-color: var(--color-cyan-500);
  }

  .callout-didactic .callout-title {
    color: var(--color-cyan-400);
  }

  /* ========================================
     TABLE WRAPPER STYLES
     Responsive table styling for guides
     ======================================== */

  .table-wrapper {
    margin: var(--spacing-4) 0;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }

  .table-container {
    min-width: 100%;
  }

  /* Table element styling for guides */
  .table-wrapper table {
    width: 100%;
    border-collapse: collapse;
    background: var(--color-bg-surface);
    font-size: 0.875rem;
  }

  .table-wrapper th,
  .table-wrapper td {
    padding: var(--spacing-3) var(--spacing-4);
    text-align: left;
    border-bottom: 1px solid var(--color-border-default);
  }

  .table-wrapper thead th {
    background: var(--color-bg-accent-subtle);
    font-weight: 600;
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.025em;
    color: var(--color-text-accent);
    border-bottom: 2px solid var(--color-border-accent);
  }

  .table-wrapper tbody tr:hover {
    background: var(--color-bg-hover);
  }

  /* Numeric table styling - for fit indices, stats tables */
  .table-wrapper td:nth-child(n+2) {
    font-variant-numeric: tabular-nums;
  }

  /* First column often has labels - keep left aligned */
  .table-wrapper td:first-child {
    font-weight: 500;
  }

  /* ========================================
     SIDE-BY-SIDE COMPARISON TABLES
     v1.3: Enhanced visual distinction
     - Prominent accent border for clear separation
     - Elevated surface with stronger lift
     - Generous spacing from surrounding content
     ======================================== */

  /* Comparison tables (2-column conceptual comparisons) */
  .guide-content table[width="100%"],
  .guide-content table:has(th[width="50%"]) {
    /* Outer container - lifts off the page with accent border */
    background: var(--color-bg-elevated);
    border: 2px solid var(--color-accent-500);
    border-radius: var(--radius-xl);
    box-shadow:
      0 6px 20px rgba(0, 0, 0, 0.2),
      0 2px 6px rgba(0, 0, 0, 0.12),
      inset 0 1px 0 rgba(255, 255, 255, 0.05);
    overflow: hidden;
    margin: 2.5rem 0;
  }

  /* Accent glow effect for dark mode */
  [data-theme="dark"] .guide-content table:has(th[width="50%"]),
  [data-theme="dracula"] .guide-content table:has(th[width="50%"]) {
    box-shadow:
      0 0 0 1px rgba(6, 182, 212, 0.2),
      0 6px 20px rgba(0, 0, 0, 0.25),
      0 2px 6px rgba(0, 0, 0, 0.15),
      inset 0 1px 0 rgba(255, 255, 255, 0.05);
  }

  /* Comparison table headers - column labels */
  .guide-content table:has(th[width="50%"]) th {
    background: linear-gradient(
      180deg,
      rgba(255, 255, 255, 0.03) 0%,
      transparent 100%
    );
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    padding: 1rem 1.25rem;
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--color-text-primary);
    text-transform: none;
    letter-spacing: normal;
  }

  /* Comparison table cells - inset panel effect */
  .guide-content table:has(th[width="50%"]) td {
    background: rgba(0, 0, 0, 0.12);
    border: none;
    border-bottom: 1px solid rgba(255, 255, 255, 0.04);
    padding: 1.25rem;
    vertical-align: top;
    /* Inset effect for each cell */
    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.08);
  }

  /* Column separator */
  .guide-content table:has(th[width="50%"]) td:first-child {
    border-right: 1px solid rgba(255, 255, 255, 0.06);
  }

  /* Hover state for rows */
  .guide-content table:has(th[width="50%"]) tr:hover td {
    background: rgba(0, 0, 0, 0.08);
  }

  /* Last row - no bottom border */
  .guide-content table:has(th[width="50%"]) tr:last-child td {
    border-bottom: none;
  }

  /* Light mode adjustments for comparison tables */
  :root:not(.dark) .guide-content table:has(th[width="50%"]) {
    background: #f8fafc;
    border: 2px solid var(--color-accent-600);
    box-shadow:
      0 6px 20px rgba(0, 0, 0, 0.1),
      0 2px 6px rgba(0, 0, 0, 0.06);
  }

  :root:not(.dark) .guide-content table:has(th[width="50%"]) th {
    background: linear-gradient(
      180deg,
      rgba(0, 0, 0, 0.02) 0%,
      transparent 100%
    );
    border-bottom-color: rgba(0, 0, 0, 0.1);
  }

  :root:not(.dark) .guide-content table:has(th[width="50%"]) td {
    background: rgba(0, 0, 0, 0.03);
    border-bottom-color: rgba(0, 0, 0, 0.06);
    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.03);
  }

  :root:not(.dark) .guide-content table:has(th[width="50%"]) td:first-child {
    border-right-color: rgba(0, 0, 0, 0.08);
  }

  /* ========================================
     PRINT STYLES FOR GUIDES
     Ensure guides print correctly
     ======================================== */

  @media print {
    /* Hide copy buttons in print */
    .copy-btn,
    .guide-copy-btn {
      display: none !important;
    }

    /* Force collapsible modules open in print */
    .tutorial-module {
      border: none;
    }

    .tutorial-module[open],
    .tutorial-module:not([open]) {
      /* Force display of content regardless of open state */
    }

    .tutorial-module summary {
      /* Style as a regular heading in print */
      background: none;
      padding: 0;
      font-size: 1.25rem;
      margin-bottom: 0.5rem;
    }

    .tutorial-module summary::before {
      /* Hide the chevron in print */
      display: none;
    }

    .tutorial-module .module-content {
      display: block !important;
      border-top: none;
      padding: 0;
    }

    /* Ensure code blocks are legible */
    .code-block-wrapper pre {
      padding: var(--spacing-3);
      padding-top: var(--spacing-3); /* Override extra padding for copy button */
      background-color: #f5f5f5 !important;
      border: 1px solid #ddd !important;
      font-size: 0.75rem;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    /* Callouts - simplify for print */
    .callout {
      background-color: #f9f9f9 !important;
      border-left-width: 3px;
      page-break-inside: avoid;
    }

    /* Avoid page breaks inside modules and callouts */
    .tutorial-module,
    .callout,
    .code-block-wrapper {
      page-break-inside: avoid;
    }
  }

  /* ========================================
     LEFT NAVIGATION COMPONENTS
     Dark sidebar matching right aside theme
     ======================================== */

  /* Main left nav container - full height sticky sidebar */
  .left-nav-container {
    background-color: var(--color-aside-bg);
    backdrop-filter: blur(12px);
    border-right: 1px solid var(--color-aside-border);
    box-shadow: var(--shadow-md);
  }

  /* Left nav header section with branding */
  .left-nav-header {
    border-bottom: 1px solid var(--color-aside-border);
    background: linear-gradient(to right, var(--color-aside-bg-solid), rgba(51, 65, 85, 0.9));
  }

  /* Brand icon container */
  .left-nav-brand-icon {
    width: 2rem;
    height: 2rem;
    background: linear-gradient(to bottom right, var(--color-accent-400), var(--color-accent-600));
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-md);
  }

  /* Brand title with gradient text */
  .left-nav-brand-title {
    font-size: 1.25rem;
    font-weight: var(--font-weight-semibold);
    background: linear-gradient(to right, var(--color-accent-400), var(--color-accent-500));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    line-height: 1.3;
  }

  /* Brand subtitle */
  .left-nav-brand-subtitle {
    font-size: 0.8125rem;
    color: var(--color-aside-text-secondary);
    line-height: 1.2;
    margin-top: 0.125rem;
  }

  /* Collapse/expand button */
  .left-nav-collapse-btn {
    padding: var(--spacing-2);
    color: var(--color-aside-text-secondary);
    border-radius: var(--radius-lg);
    transition: all 0.2s ease-in-out;
  }

  .left-nav-collapse-btn:hover {
    color: var(--color-aside-hover-text);
    background-color: var(--color-aside-hover-bg);
  }

  .left-nav-collapse-btn:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px var(--color-accent-400);
  }

  /* Search input container */
  .left-nav-search-container {
    padding: var(--spacing-3) var(--spacing-4);
    border-bottom: 1px solid var(--color-aside-border);
  }

  /* Search input field */
  .left-nav-search {
    width: 100%;
    background-color: var(--color-aside-hover-bg);
    border: 1px solid transparent;
    border-radius: var(--radius-lg);
    padding: var(--spacing-2) var(--spacing-3) var(--spacing-2) 2.5rem;
    font-size: 0.875rem;
    color: var(--color-aside-text-primary);
    transition: all 0.2s ease-in-out;
  }

  .left-nav-search::placeholder {
    color: var(--color-aside-text-secondary);
  }

  .left-nav-search:hover {
    background-color: rgba(51, 65, 85, 0.25);
  }

  .left-nav-search:focus {
    outline: none;
    background-color: rgba(51, 65, 85, 0.3);
    border-color: var(--color-accent-400);
    box-shadow: 0 0 0 1px var(--color-accent-400);
  }

  /* Search icon */
  .left-nav-search-icon {
    position: absolute;
    left: 0.75rem;
    top: 0.625rem;
    width: 1rem;
    height: 1rem;
    color: var(--color-aside-text-secondary);
  }

  /* Clear search button */
  .left-nav-search-clear {
    position: absolute;
    right: 0.5rem;
    top: 0.5rem;
    padding: 0.25rem;
    color: var(--color-aside-text-secondary);
    border-radius: var(--radius-sm);
    transition: color 0.2s;
  }

  .left-nav-search-clear:hover {
    color: var(--color-aside-text-primary);
  }

  /* Navigation link item */
  .left-nav-link {
    display: flex;
    align-items: center;
    font-size: 0.875rem;
    font-weight: var(--font-weight-medium);
    border-radius: var(--radius-lg);
    border-left: 3px solid transparent;
    transition: all 0.2s ease-in-out;
  }

  .left-nav-link:hover {
    background-color: var(--color-aside-hover-bg);
    border-left-color: var(--color-aside-hover-border);
  }

  .left-nav-link:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px var(--color-accent-400);
  }

  /* Active navigation link - subtle background with left border accent */
  .left-nav-link-active {
    background-color: rgba(6, 182, 212, 0.08);
    border-left-color: var(--color-accent-400);
  }

  .left-nav-link-active:hover {
    background-color: rgba(6, 182, 212, 0.12);
  }

  /* Link text content - tutorial titles (smaller, less prominent than categories) */
  .left-nav-link-title {
    color: rgba(226, 232, 240, 0.9); /* Slightly muted white */
    font-weight: var(--font-weight-regular);
    line-height: 1.2;
    font-size: 0.8125rem; /* Slightly smaller for better fit */
    text-shadow: 0 0 15px rgba(6, 182, 212, 0.08); /* Very subtle glow */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .left-nav-link:hover .left-nav-link-title {
    color: var(--color-accent-200);
    text-shadow: 0 0 18px rgba(6, 182, 212, 0.25);
  }

  .left-nav-link-active .left-nav-link-title {
    color: var(--color-accent-300);
    font-weight: var(--font-weight-semibold);
    text-shadow: 0 0 20px rgba(6, 182, 212, 0.35);
  }

  /* Link description text */
  .left-nav-link-description {
    font-size: 0.75rem;
    color: var(--color-aside-text-secondary);
    margin-top: 0.125rem;
  }

  .left-nav-link-active .left-nav-link-description {
    color: rgba(255, 255, 255, 0.9);
  }

  .hero-header {
    position: relative;
  }

  .hero-kicker {
    text-transform: uppercase;
    letter-spacing: 0.3em;
    font-size: 0.85rem;
    background: linear-gradient(90deg, rgba(129, 140, 248, 0.95), rgba(56, 189, 248, 0.95));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  /* Light mode - darker gradient for visibility */
  :root .hero-kicker,
  [data-theme="light"] .hero-kicker {
    background: linear-gradient(90deg, rgba(59, 130, 246, 0.95), rgba(14, 165, 233, 0.95));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  /* Dark modes - lighter gradient */
  [data-theme="dark"] .hero-kicker,
  [data-theme="dracula"] .hero-kicker {
    background: linear-gradient(90deg, rgba(129, 140, 248, 0.95), rgba(56, 189, 248, 0.95));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .hero-description {
    max-width: 70ch;
    line-height: 1.65;
    margin-top: 0.35rem;
  }

  .hero-breadcrumb {
    color: rgba(100, 116, 139, 0.85);
    font-size: 0.95rem;
  }

  /* Dark mode breadcrumb */
  [data-theme="dark"] .hero-breadcrumb,
  [data-theme="dracula"] .hero-breadcrumb {
    color: rgba(226, 232, 240, 0.75);
  }

  .hero-pill {
    display: inline-flex;
    align-items: center;
    border-radius: 999px;
    padding: 0.25rem 0.7rem;
    font-size: 0.8rem;
    font-weight: 500;
    border: 1px solid transparent;
    backdrop-filter: blur(10px);
    box-shadow: 0 8px 22px rgba(15, 23, 42, 0.3);
  }

  /* Light mode pills (default / :root) */
  .hero-pill--primary {
    background: rgba(59, 130, 246, 0.15);
    border-color: rgba(59, 130, 246, 0.35);
    color: rgba(15, 23, 42, 0.9);
    box-shadow: 0 6px 16px rgba(15, 23, 42, 0.15);
  }

  .hero-pill--secondary {
    background: rgba(148, 163, 184, 0.2);
    border-color: rgba(100, 116, 139, 0.35);
    color: rgba(15, 23, 42, 0.85);
  }

  .hero-pill--tag {
    background: rgba(2, 132, 199, 0.12);
    border-color: rgba(2, 132, 199, 0.3);
    color: rgba(15, 23, 42, 0.9);
  }

  /* Dark mode pills */
  [data-theme="dark"] .hero-pill--primary,
  [data-theme="dracula"] .hero-pill--primary {
    background: linear-gradient(120deg, rgba(59, 130, 246, 0.25), rgba(14, 165, 233, 0.25));
    border-color: rgba(59, 130, 246, 0.4);
    color: var(--color-accent-50);
  }

  [data-theme="dark"] .hero-pill--secondary,
  [data-theme="dracula"] .hero-pill--secondary {
    background: rgba(148, 163, 184, 0.15);
    border-color: rgba(148, 163, 184, 0.4);
    color: rgba(226, 232, 240, 0.85);
  }

  [data-theme="dark"] .hero-pill--tag,
  [data-theme="dracula"] .hero-pill--tag {
    background: rgba(2, 132, 199, 0.08);
    border-color: rgba(2, 132, 199, 0.35);
    color: rgba(191, 219, 254, 0.95);
  }

  /* Hover states - different for light/dark */
  .hero-pill--tag:hover,
  .hero-pill--secondary:hover,
  .hero-pill--primary:hover {
    border-color: rgba(100, 116, 139, 0.6);
    color: rgba(15, 23, 42, 1);
  }

  [data-theme="dark"] .hero-pill--tag:hover,
  [data-theme="dark"] .hero-pill--secondary:hover,
  [data-theme="dark"] .hero-pill--primary:hover,
  [data-theme="dracula"] .hero-pill--tag:hover,
  [data-theme="dracula"] .hero-pill--secondary:hover,
  [data-theme="dracula"] .hero-pill--primary:hover {
    border-color: rgba(255, 255, 255, 0.6);
    color: #fff;
  }

  /* ========================================
     RESOURCE ROWS - COMPACT LIST LAYOUT
     Collapsible container with scannable list
     ======================================== */

  /* Collapsible details container */
  .resources-details {
    display: grid;
    grid-template-rows: auto 0fr;
    transition: grid-template-rows 0.3s ease-out;
  }

  .resources-details[open] {
    grid-template-rows: auto 1fr;
  }

  /* Summary (clickable header) */
  .resources-summary {
    cursor: pointer;
    list-style: none;
    user-select: none;
    padding: var(--spacing-4) var(--spacing-5);
    border-radius: var(--radius-lg);
    background-color: var(--color-bg-subtle);
    transition: all 180ms ease;
  }

  .resources-summary:hover {
    background-color: var(--color-bg-surface);
    box-shadow: var(--shadow-sm);
  }

  /* Remove default details marker */
  .resources-summary::-webkit-details-marker,
  .resources-summary::marker {
    display: none;
  }

  .resources-summary-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-4);
  }

  /* Chevron rotation when expanded */
  .resources-details[open] .resources-chevron {
    transform: rotate(180deg);
  }

  /* Wrapper for animated content */
  .resources-content-wrapper {
    overflow: hidden;
    padding: 0 var(--spacing-5);
  }

  /* Resource list container */
  .resource-list {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-4);
    padding-top: var(--spacing-6);
    padding-bottom: var(--spacing-2);
  }

  /* Individual resource row */
  .resource-row {
    padding: var(--spacing-4);
    border: 1px solid var(--color-border-default);
    border-radius: var(--radius-lg);
    background-color: var(--color-bg-subtle);
    transition: all 180ms ease;
  }

  .resource-row:hover {
    border-color: var(--color-accent-400);
    background-color: var(--color-bg-surface);
    box-shadow: var(--shadow-sm);
  }

  /* Row header (icon + title + badge) */
  .resource-row-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-3);
    margin-bottom: var(--spacing-2);
  }

  .resource-row-icon {
    flex-shrink: 0;
    width: 2rem;
    height: 2rem;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-accent-500);
  }

  .resource-row-title {
    flex: 1;
    font-size: var(--font-size-body);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
    margin: 0;
  }

  .resource-row-badge {
    flex-shrink: 0;
    font-size: 0.625rem;
  }

  /* Row body (description + link) */
  .resource-row-body {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    gap: var(--spacing-4);
    margin-left: 3.75rem;
  }

  .resource-row-description {
    flex: 1;
    font-size: var(--font-size-supporting);
    color: var(--color-text-secondary);
    line-height: 1.5;
    margin: 0;
  }

  .resource-row-link {
    flex-shrink: 0;
    display: inline-flex;
    align-items: center;
    gap: var(--spacing-2);
    padding: var(--spacing-2) var(--spacing-3);
    font-size: var(--font-size-supporting);
    font-weight: var(--font-weight-medium);
    color: var(--color-neutral-900);
    background: var(--color-accent-500);
    border-radius: var(--radius-md);
    text-decoration: none;
    transition: all 180ms ease;
    white-space: nowrap;
  }

  .resource-row-link:hover {
    background: var(--color-accent-600);
    transform: translateY(-1px);
    box-shadow: var(--shadow-sm);
  }

  .resource-row-link:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px var(--color-accent-500), 0 0 0 4px var(--color-accent-100);
  }

  /* Mobile: Stack description and link */
  @media (max-width: 768px) {
    .resource-row-header {
      flex-wrap: wrap;
    }

    .resource-row-body {
      flex-direction: column;
      align-items: flex-start;
      margin-left: 0;
      gap: var(--spacing-3);
    }

    .resource-row-link {
      width: 100%;
      justify-content: center;
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .resource-row:hover,
    .resource-row-link:hover {
      transform: none;
    }
  }

  /* Remove default browser disclosure markers from Data Access details/summary */
  .resource-details summary {
    list-style: none !important;
  }

  .resource-details summary::-webkit-details-marker,
  .resource-details summary::marker {
    display: none !important;
  }

  .resource-summary {
    list-style: none !important;
  }

  .resource-summary::-webkit-details-marker,
  .resource-summary::marker {
    display: none !important;
  }

  /* ========================================
     DATA ACCESS TABS - Legacy CSS-only system removed
     Current implementation uses native HTML5 <details>/<summary> elements
     See: src/sections/data_access_section.rs
     ======================================== */

  /* ========================================
     COLLAPSIBLE CODE BLOCKS
     CSS-only expandable code with <details>
     ======================================== */

  /* Constrain cards containing collapsible code blocks */
  .card:has(.code-collapsible) {
    overflow: hidden;
    min-width: 0;
  }

  /* Code collapsible container - uses grid-template-rows animation for smooth height transitions */
  .code-collapsible {
    display: grid;
    /* Hidden by default: 0fr collapses the grid row */
    grid-template-rows: auto 0fr;
    transition: grid-template-rows 220ms ease-out;
    width: 100%;
    min-width: 0; /* Critical: prevents grid from expanding beyond container */
    margin: 0;
    padding: 0;
  }

  /* When open: allow content to show with 1fr */
  .code-collapsible[open] {
    grid-template-rows: auto 1fr;
  }

  /* Respect reduced-motion preference */
  @media (prefers-reduced-motion: reduce) {
    .code-collapsible {
      transition: none;
    }
  }

  /* Code summary (clickable header) */
  .code-summary {
    cursor: pointer;
    list-style: none;
    user-select: none;
    padding: var(--spacing-2) 0;
    margin: 0;
    width: 100%;
  }

  /* Remove default details marker */
  .code-summary::-webkit-details-marker,
  .code-summary::marker {
    display: none;
  }

  /* Hover effect on summary */
  .code-summary:hover {
    opacity: 0.8;
  }

  /* Line count badge styling */
  .code-line-count {
    opacity: 0.7;
  }

  /* Chevron rotation when expanded - smooth transition */
  .code-chevron {
    transition: transform 220ms ease-out;
  }

  .code-collapsible[open] .code-chevron {
    transform: rotate(180deg);
  }

  /* Disable chevron animation for reduced-motion */
  @media (prefers-reduced-motion: reduce) {
    .code-chevron {
      transition: none;
    }
  }

  /* Code content wrapper for smooth animation with opacity fade */
  .code-content-wrapper {
    /* MUST hide overflow for grid 0fr to work */
    overflow: hidden;
    min-width: 0; /* Critical: allows proper shrinking in grid */
    width: 100%; /* Force wrapper to use available width, not content width */
    min-height: 0; /* Allow grid to size this properly */
    opacity: 0;
    transition: opacity 180ms ease-out;
  }

  /* Fade in content when expanded */
  .code-collapsible[open] .code-content-wrapper {
    opacity: 1;
  }

  /* Disable opacity animation for reduced-motion */
  @media (prefers-reduced-motion: reduce) {
    .code-content-wrapper {
      opacity: 1;
      transition: none;
    }
  }

  /* Code metadata row - displays language, filename, and line count */
  .code-meta {
    display: flex;
    align-items: center;
    gap: var(--spacing-3);
    padding: var(--spacing-2) 0;
    margin-top: var(--spacing-2);
    font-size: 0.75rem; /* text-xs */
    color: var(--color-text-secondary);
  }

  /* Filename display in code metadata */
  .code-filename {
    font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace;
    font-size: 0.75rem; /* text-xs */
    color: var(--color-text-muted);
  }

  /* Line count in metadata context (not in summary) */
  .code-meta .code-line-count {
    font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Consolas, 'DejaVu Sans Mono', monospace;
    font-size: 0.75rem; /* text-xs */
    color: var(--color-text-muted);
    opacity: 0.8;
  }

  /* Ensure code panel doesn't overflow */
  .code-content-wrapper .panel {
    min-width: 0; /* Allows flex/grid children to shrink below content size */
    width: 100%;
    max-width: 100%; /* Prevent expansion beyond container */
    border: none; /* Remove inner border - outer card provides containment */
  }

  /* When open: limit to ~15 lines for preview mode */
  .code-collapsible[open] .code-content-wrapper .panel {
    max-height: 22.5em;
    overflow-y: auto;
    transition: max-height 220ms ease-out;
  }

  /* Disable max-height animation for reduced-motion */
  @media (prefers-reduced-motion: reduce) {
    .code-collapsible[open] .code-content-wrapper .panel {
      transition: none;
    }
  }

  /* Constrain pre element within collapsible code blocks */
  .code-content-wrapper pre {
    /* DO NOT set width: 100% - it calculates from content, not container */
    max-width: 100%;
    box-sizing: border-box; /* Include padding in width calculation */
    contain: inline-size; /* Prevent content from expanding parent width */
    /* Dark background for syntax highlighting visibility */
    background-color: #0d1117;  /* GitHub dark bg - matches guide code blocks */
    border-radius: var(--radius-md);
    padding: 1rem 1.25rem;
    overflow-x: auto;
    font-size: 0.8125rem;  /* 13px - matches guide code blocks */
    line-height: 1.65;
  }

  /* Light mode adjustment for tutorial code blocks */
  :root:not(.dark) .code-content-wrapper pre {
    background-color: #1e1e1e;  /* VS Code dark */
  }

  /* Force nested cards containing code blocks to respect parent width */
  .card .card:has(.code-collapsible) {
    max-width: 100%;
  }

  /* Ensure code element inside pre doesn't expand parent */
  .code-content-wrapper pre code {
    display: block;
    max-width: 100%;
    font-family: var(--font-mono);
    background: transparent;
    padding: 0;
    color: #e6edf3;  /* Light text on dark bg */
  }

  /* Ensure code text is always light on dark background */
  :root:not(.dark) .code-content-wrapper pre code {
    color: #d4d4d4;
  }

  /* Focus state for accessibility */
  .code-summary:focus-visible {
    outline: 2px solid var(--color-accent-500);
    outline-offset: 2px;
    border-radius: var(--radius-md);
  }

  /* ========================================
     Full expansion toggle (CSS checkbox hack)
     ======================================== */

  /* Hide the checkbox visually but keep it accessible */
  .code-expand-checkbox {
    position: absolute;
    opacity: 0;
    pointer-events: none;
  }

  /* Style the toggle link - combines with .btn-secondary for button-like appearance */
  .code-expand-toggle {
    /* Spacing override for code block context */
    margin-top: var(--spacing-2);
    /* Center text within button */
    text-align: center;
  }

  /* Toggle text visibility based on checkbox state */
  .code-expand-toggle .when-expanded {
    display: none;
  }

  .code-expand-checkbox:checked ~ .code-expand-toggle .when-collapsed {
    display: none;
  }

  .code-expand-checkbox:checked ~ .code-expand-toggle .when-expanded {
    display: inline;
  }

  /* Remove max-height when checkbox is checked (full expansion) */
  .code-content-wrapper:has(.code-expand-checkbox:checked) .panel {
    max-height: none !important;
  }
}

/* Data Access tab visibility (CSS-only via :has and ~) */
@layer utilities {
  /* Hover states */
  .hover\:bg-subtle:hover {
    background-color: var(--color-bg-subtle);
  }

  /* Focus ring states */
  .focus\:ring-accent:focus {
    outline: none;
    box-shadow: 0 0 0 2px var(--color-accent-500), 0 0 0 4px var(--color-accent-100);
  }

  /* Peer-checked tab styling */
  .peer-checked\:bg-accent-subtle:has(+ .peer:checked),
  .peer:checked ~ .peer-checked\:bg-accent-subtle {
    background-color: var(--color-bg-accent-subtle);
  }

  .peer-checked\:border-accent:has(+ .peer:checked),
  .peer:checked ~ .peer-checked\:border-accent {
    border-color: var(--color-border-accent);
  }

  .peer-checked\:font-semibold:has(+ .peer:checked),
  .peer:checked ~ .peer-checked\:font-semibold {
    font-weight: 600;
  }

  .peer-checked\:bg-accent:has(+ .peer:checked),
  .peer:checked ~ .peer-checked\:bg-accent {
    background-color: var(--color-bg-accent);
  }

  .peer-checked\:text-white:has(+ .peer:checked),
  .peer:checked ~ .peer-checked\:text-white {
    color: #ffffff;
  }

  /* Legacy Data Access tab selectors removed - unused in current implementation */

  /* ========================================
     Output Images - Placeholder Styling
     ======================================== */

  /* Placeholder images: smaller and faded to distinguish from actual content
     Placed in @layer utilities to override w-full class (width: 100%) */
  img[src*="placeholder.png"] {
    width: 12rem; /* 192px - about 1/4 of actual images */
    height: 12rem;
    max-width: 12rem;
    max-height: 12rem;
    opacity: 0.5; /* Semi-transparent to indicate placeholder status */
  }

  /* ========================================
     STAGE4 ARTIFACT SIZING
     Consistent sizing for images and tables from stage4-artifacts
     ======================================== */

  /* Stage4 PNG images - visualization plots */
  img[src*="stage4-artifacts"] {
    max-width: 28rem; /* temporary 448px cap for review */
    width: 100%; /* Responsive - scales down on smaller screens */
    height: auto; /* Maintain aspect ratio */
    margin-left: auto;
    margin-right: auto;
    display: block; /* Center the image */
  }

  /* Table styling consolidated with main .card table rules above (line ~809)
     Duplicate width declaration removed to avoid redundancy */

  /* ========================================
     DATA ACCESS CONTENT STYLING
     Enhanced prose styling for Data Access section
     ======================================== */

  /* Simple container - minimal styling */
  .data-access-simple-container {
    padding: var(--spacing-4);
    background-color: var(--color-bg-canvas);
  }

  .data-access-content {
    max-width: none;
  }

  /* Remove default h1 from prose content (we have section header) */
  .data-access-content h1 {
    display: none;
  }

  /* Bold section headings (Data Download, Required Variables, etc.) */
  .data-access-content p > strong:only-child {
    display: block;
    font-size: var(--font-size-panel-title);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-accent);
    margin-top: var(--spacing-6);
    margin-bottom: var(--spacing-3);
    line-height: var(--leading-tight);
  }

  /* Regular paragraphs */
  .data-access-content p {
    font-size: var(--font-size-body);
    line-height: var(--leading-longform);
    color: var(--color-text-primary);
    margin-bottom: var(--spacing-4);
  }

  /* Unordered lists - styled with accent color */
  .data-access-content ul {
    list-style: none;
    margin: var(--spacing-4) 0;
    padding-left: 0;
  }

  .data-access-content ul li {
    position: relative;
    padding-left: var(--spacing-6);
    margin-bottom: var(--spacing-3);
    font-size: var(--font-size-body);
    line-height: var(--leading-normal);
    color: var(--color-text-primary);
  }

  /* Custom bullet with accent color */
  .data-access-content ul li::before {
    content: "";
    position: absolute;
    left: 0;
    top: 0.6em;
    width: 0.5rem;
    height: 0.5rem;
    background-color: var(--color-accent-500);
    border-radius: 50%;
  }

  /* Nested list items with bold labels (e.g., **mh_y_erq__suppr_mean** - Description) */
  .data-access-content ul li strong:first-child {
    color: var(--color-text-accent);
    font-weight: var(--font-weight-semibold);
  }

  /* Links - styled with accent color and hover effects */
  .data-access-content a {
    color: var(--color-text-accent);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color 0.2s, color 0.2s;
    font-weight: var(--font-weight-medium);
  }

  .data-access-content a:hover {
    border-bottom-color: var(--color-accent-500);
  }

  .data-access-content a:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px var(--color-accent-500), 0 0 0 4px var(--color-accent-100);
    border-radius: var(--radius-sm);
  }

  /* Code blocks - simple minimal styling */
  .data-access-content pre {
    background-color: var(--color-bg-canvas);
    color: var(--color-code-text);
    border: 1px solid var(--color-border-default);
    padding: var(--spacing-4);
    margin: var(--spacing-4) 0;
    overflow-x: auto;
  }

  .data-access-content pre code {
    font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Monaco, 'Courier New', monospace;
    font-size: 0.9em;
    line-height: 1.6;
    color: var(--color-code-text);
  }

  /* Inline code */
  .data-access-content :not(pre) > code {
    background-color: var(--color-bg-accent-subtle);
    color: var(--color-text-accent);
    padding: 0.125rem 0.5rem;
    border-radius: var(--radius-sm);
    font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Monaco, 'Courier New', monospace;
    font-size: 0.9em;
    font-weight: var(--font-weight-medium);
    border: 1px solid var(--color-border-accent);
  }

  /* Add spacing between major sections */
  .data-access-content > div > p > strong:only-child {
    scroll-margin-top: 6rem; /* Offset for sticky header */
  }

  /* Improve spacing for consecutive paragraphs */
  .data-access-content p + ul {
    margin-top: calc(-1 * var(--spacing-2));
  }

  .data-access-content ul + p {
    margin-top: var(--spacing-4);
  }

  /* Dark mode adjustments */
  [data-theme="dark"] .data-access-content ul li::before {
    background-color: var(--color-accent-400);
  }

  /* Dracula theme adjustments */
  [data-theme="dracula"] .data-access-content ul li::before {
    background-color: var(--color-accent-300);
  }

  /* ========================================
     NOTE CARD CONTENT STYLING
     Rich HTML content in note/interpretation cards
     ======================================== */

  /* Note card styling - info boxes in Data Prep/Stats sections */
  .note-card {
    padding: var(--spacing-6);
    text-align: center;
  }

  /* Note content - rich HTML from markdown */
  .note-content {
    text-align: left;
    max-width: none;
  }

  /* Paragraphs in note content */
  .note-content p {
    font-size: var(--font-size-body);
    line-height: var(--leading-longform);
    color: var(--color-text-primary);
    margin-bottom: var(--spacing-4);
  }

  .note-content p:last-child {
    margin-bottom: 0;
  }

  /* Lists in note content */
  .note-content ul,
  .note-content ol {
    margin: var(--spacing-4) 0;
    padding-left: var(--spacing-6);
  }

  .note-content ul {
    list-style: disc;
  }

  .note-content ol {
    list-style: decimal;
  }

  .note-content li {
    font-size: var(--font-size-body);
    line-height: var(--leading-normal);
    color: var(--color-text-primary);
    margin-bottom: var(--spacing-2);
  }

  .note-content li::marker {
    color: var(--color-accent-500);
  }

  /* Bold text in notes */
  .note-content strong {
    color: var(--color-text-accent);
    font-weight: var(--font-weight-semibold);
  }

  /* Links in notes */
  .note-content a {
    color: var(--color-text-accent);
    text-decoration: underline;
    text-underline-offset: 2px;
  }

  .note-content a:hover {
    color: var(--color-accent-600);
  }

  /* Code in notes */
  .note-content code {
    background-color: var(--color-bg-accent-subtle);
    color: var(--color-text-accent);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-family: ui-monospace, 'Cascadia Code', 'Source Code Pro', Menlo, Monaco, 'Courier New', monospace;
    font-size: 0.9em;
  }

  /* Code blocks in notes */
  .note-content pre {
    background-color: var(--color-bg-canvas);
    border: 1px solid var(--color-border-default);
    padding: var(--spacing-4);
    margin: var(--spacing-4) 0;
    overflow-x: auto;
    border-radius: var(--radius-md);
  }

  .note-content pre code {
    background: none;
    padding: 0;
    font-size: 0.85em;
    line-height: 1.6;
  }

  /* Tables in notes */
  .note-content table {
    width: 100%;
    border-collapse: collapse;
    margin: var(--spacing-4) 0;
    font-size: var(--font-size-sm);
  }

  .note-content th,
  .note-content td {
    padding: var(--spacing-2) var(--spacing-3);
    text-align: left;
    border-bottom: 1px solid var(--color-border-subtle);
  }

  .note-content th {
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-accent);
    background-color: var(--color-bg-accent-subtle);
  }

  /* Dark mode adjustments for note content */
  [data-theme="dark"] .note-content li::marker,
  [data-theme="dracula"] .note-content li::marker {
    color: var(--color-accent-400);
  }

  /* ========================================
     DISCUSSION SECTION STYLING
     ======================================== */

  /* Discussion items spacing */
  .discussion-item {
    padding-bottom: var(--spacing-6);
    border-bottom: 1px solid var(--color-border-subtle);
  }

  .discussion-item:last-child {
    border-bottom: none;
    padding-bottom: 0;
  }

  /* Prose styling for discussion content - inherit from note-content */
  .discussion-item .prose {
    text-align: left;
    max-width: none;
  }

  .discussion-item .prose p,
  .discussion-item .prose ul,
  .discussion-item .prose ol,
  .discussion-item .prose li,
  .discussion-item .prose strong,
  .discussion-item .prose a,
  .discussion-item .prose code,
  .discussion-item .prose pre,
  .discussion-item .prose table,
  .discussion-item .prose th,
  .discussion-item .prose td {
    /* Inherit from note-content styles */
  }

  /* Discussion paragraphs */
  .discussion-item .prose p {
    font-size: var(--font-size-body);
    line-height: var(--leading-longform);
    color: var(--color-text-primary);
    margin-bottom: var(--spacing-4);
  }

  .discussion-item .prose p:last-child {
    margin-bottom: 0;
  }

  /* Discussion lists */
  .discussion-item .prose ul,
  .discussion-item .prose ol {
    margin: var(--spacing-4) 0;
    padding-left: var(--spacing-6);
  }

  .discussion-item .prose li {
    font-size: var(--font-size-body);
    line-height: var(--leading-normal);
    color: var(--color-text-primary);
    margin-bottom: var(--spacing-2);
  }

  /* Bold labels in discussion */
  .discussion-item .prose strong {
    color: var(--color-text-accent);
    font-weight: var(--font-weight-semibold);
  }

  /* ========================================
     WORK IN PROGRESS BADGE - Tooltip on hover
     ======================================== */

  /* Container */
  .wip-badge-container {
    display: inline-flex;
  }

  /* Badge with tooltip - purple/pink color scheme */
  .wip-badge {
    position: relative;
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.375rem 0.75rem;
    border-radius: 9999px;
    font-size: 0.75rem;
    font-weight: 600;
    letter-spacing: 0.025em;
    transition: all 0.2s;
    cursor: help;
    border: 1px solid rgba(168, 85, 247, 0.3);
    background-color: rgba(168, 85, 247, 0.1);
    color: rgb(126, 34, 206);
  }

  .wip-badge:hover {
    background-color: rgba(168, 85, 247, 0.15);
    border-color: rgba(168, 85, 247, 0.4);
  }

  [data-theme="dark"] .wip-badge {
    border-color: rgba(192, 132, 252, 0.3);
    background-color: rgba(192, 132, 252, 0.1);
    color: rgb(216, 180, 254);
  }

  [data-theme="dark"] .wip-badge:hover {
    background-color: rgba(192, 132, 252, 0.15);
    border-color: rgba(192, 132, 252, 0.4);
  }

  [data-theme="dracula"] .wip-badge {
    border-color: rgba(189, 147, 249, 0.3);
    background-color: rgba(189, 147, 249, 0.1);
    color: rgb(189, 147, 249);
  }

  [data-theme="dracula"] .wip-badge:hover {
    background-color: rgba(189, 147, 249, 0.15);
    border-color: rgba(189, 147, 249, 0.4);
  }

  /* Info icon */
  .wip-badge-icon {
    width: 1rem;
    height: 1rem;
    flex-shrink: 0;
  }

  /* Badge label text */
  .wip-badge-label {
    white-space: nowrap;
  }

  /* Tooltip - hidden by default */
  .wip-badge-tooltip {
    position: absolute;
    bottom: calc(100% + 0.5rem);
    left: 50%;
    transform: translateX(-50%);
    padding: 0.75rem 1rem;
    border-radius: 0.5rem;
    background-color: rgb(17, 24, 39);
    color: rgb(243, 244, 246);
    font-size: 0.875rem;
    font-weight: 400;
    line-height: 1.5;
    white-space: normal;
    width: max-content;
    max-width: 20rem;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5), 0 4px 6px -4px rgba(0, 0, 0, 0.3);
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.25s ease-in-out, visibility 0.25s ease-in-out;
    pointer-events: none;
    z-index: 9999;
  }

  /* Tooltip arrow */
  .wip-badge-tooltip::after {
    content: "";
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 0.375rem solid transparent;
    border-top-color: rgb(17, 24, 39);
  }

  /* Show tooltip on hover */
  .wip-badge:hover .wip-badge-tooltip {
    opacity: 1;
    visibility: visible;
  }

  /* Dark mode tooltip */
  [data-theme="dark"] .wip-badge-tooltip {
    background-color: rgb(31, 41, 55);
    color: rgb(229, 231, 235);
  }

  [data-theme="dark"] .wip-badge-tooltip::after {
    border-top-color: rgb(31, 41, 55);
  }

  /* Dracula theme tooltip */
  [data-theme="dracula"] .wip-badge-tooltip {
    background-color: rgb(40, 42, 54);
    color: rgb(248, 248, 242);
  }

  [data-theme="dracula"] .wip-badge-tooltip::after {
    border-top-color: rgb(40, 42, 54);
  }

  /* Mobile: Adjust tooltip positioning and width */
  @media (max-width: 640px) {
    .wip-badge-tooltip {
      max-width: 16rem;
      left: 50%;
      transform: translateX(-50%);
    }
  }
}
